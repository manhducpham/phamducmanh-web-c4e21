if (self.CavalryLogger) { CavalryLogger.start_js(["xCAgA"]); }

__d("VideoViewFraudDetectorWhiteOps",["FBSiteWhiteOps"],(function(a,b,c,d,e,f){"use strict";function a(a,c,d){a.setDetectionID(c),d&&a.addListener("videoView/runFraudDetector",function(){b("FBSiteWhiteOps").appendToWindow(c,"FACEBOOK_VIDEO_VIEW",null)})}e.exports=a}),null);
__d("AjaxError",[],(function(a,b,c,d,e,f){a={ERROR:"ar:error",TIMEOUT:"ar:timeout",PROXY_ERROR:"ar:proxy error",TRANSPORT_ERROR:"ar:transport error",SERVER_ERROR:"ar:http error",PARSE_ERROR:"ar:parse error",SERVICE_UNAVAILABLE:"ar:noservice"};e.exports=a}),null);
__d("AjaxRequest",["AjaxError","ErrorUtils","Keys","PHPQuerySerializer","TimeSlice","URI","UserAgent_DEPRECATED","ZeroRewrites","clearTimeout","setTimeoutAcrossTransitions"],(function(a,b,c,d,e,f){__p&&__p();var g=window.XMLHttpRequest&&"withCredentials"in new XMLHttpRequest(),h=[];function a(){var a=h;h=[];a.forEach(function(a){return a.abort()})}function i(a){a.onJSON=a.onError=a.onSuccess=null,b("clearTimeout")(a._timer),a.xhr&&a.xhr.readyState<4&&(a.xhr.abort(),a.xhr=null),h=h.filter(function(b){return b&&b!=a&&b.xhr&&b.xhr.readyState<4})}function c(a,c,d){"use strict";this.timeout=6e4,this.streamMode=!0,this.prelude=/^for \(;;\);/,this.status=null,this.$1=-1,this.$2=null,this.$3=0,this.$4=null,this.json=null,this.errorType=null,this.errorText=null,this.onJSON=null,this.onSuccess=null,this.onError=null,c instanceof b("URI")||(c=new(b("URI"))(c)),this.xhr=b("ZeroRewrites").getTransportBuilderForURI(c)(),d&&a=="GET"&&c.setQueryData(d),this.method=a,this.uri=c,this.xhr.open(a,c)}c.supportsCORS=function(){"use strict";return g};c.prototype.send=function(a){"use strict";__p&&__p();var c=b("TimeSlice").getReusableContinuation("AjaxRequest xhr.onreadystatechange");this.xhr.onreadystatechange=function(){return this.$5(c)}.bind(this);var d=this.timeout;d&&(this.$2=b("setTimeoutAcrossTransitions")(function(){this.errorType=b("AjaxError").TIMEOUT,this.errorText="timeout",this.$4=Date.now()-this.$3,this.onError&&this.onError(this),i(this)}.bind(this),d));h.push(this);this.method=="POST"&&this.xhr.setRequestHeader("Content-Type","application/x-www-form-urlencoded");this.$3=Date.now();this.xhr.send(a?b("PHPQuerySerializer").serialize(a):"")};c.prototype.abort=function(){"use strict";i(this)};c.prototype.toString=function(){"use strict";var a="[AjaxRequest readyState="+this.xhr.readyState;this.errorType&&(a+=" errorType="+this.errorType,this.errorText&&(a+=" ("+this.errorText+")"));return a+"]"};c.prototype.toJSON=function(){"use strict";var a={};this.json&&(a.json=this.json);this.status&&(a.status=this.status);this.errorType&&(a.errorType=this.errorType,a.uri=this.uri);this.errorText&&(a.errorText=this.errorText);this.$4&&(a.time=this.$4);return a};c.prototype.onJSONSafe=function(){"use strict";this.onJSON&&this.onJSON(this)};c.prototype.onSuccessSafe=function(){"use strict";this.onSuccess&&this.onSuccess(this)};c.prototype.onErrorSafe=function(){"use strict";this.onError&&this.onError(this)};c.prototype.$6=function(){"use strict";__p&&__p();var a;try{this.status=this.xhr.status,a=this.xhr.statusText}catch(a){this.xhr.readyState>=4&&(this.errorType=b("AjaxError").TRANSPORT_ERROR,this.errorText=a.message);return}var c=this.status;if(c==null){this.errorType=b("AjaxError").ERROR;this.errorText="null status code";return}if(c===0&&!/^(file|ftp)/.test(this.uri.toString()))this.errorType=b("AjaxError").TRANSPORT_ERROR;else if(c>=100&&c<200)this.errorType=b("AjaxError").PROXY_ERROR;else if(c>=200&&c<300)return;else if(c>=300&&c<400)this.errorType=b("AjaxError").PROXY_ERROR;else if(c>=400&&c<500)this.errorType=b("AjaxError").SERVER_ERROR;else if(c===503)this.errorType=b("AjaxError").SERVICE_UNAVAILABLE;else if(c>500&&c<600)this.errorType=b("AjaxError").PROXY_ERROR;else if(c==1223)return;else c>=12001&&c<=12156?this.errorType=b("AjaxError").TRANSPORT_ERROR:(a="unrecognized status code: "+c,this.errorType=b("AjaxError").ERROR);this.errorText||(this.errorText=a)};c.prototype.$7=function(){"use strict";__p&&__p();var a,c=this.xhr.readyState;try{a=this.xhr.responseText||""}catch(a){c>=4&&(this.errorType=b("AjaxError").ERROR,this.errorText="responseText not available - "+a.message);return}while(this.xhr){var d=this.$1+1,e=this.streamMode?a.indexOf("\n",d):a.length;e<0&&c==4&&(e=a.length);if(e<=this.$1)break;var f=a;this.streamMode&&(f=a.substr(d,e-d).replace(/^\s*|\s*$/g,""));if(d===0&&this.prelude){var g=this.prelude;g.test(f)&&(f=f.replace(g,""))}this.$1=e;if(f){try{this.json=JSON.parse(f)}catch(c){g=a.match(/(<body[\S\s]+?<\/body>)/i);e=g!=null&&g.length>0?g[0]:null;g={message:c.message,"char":d,excerpt:(d===0&&e||f).substr(512)};this.errorType=b("AjaxError").PARSE_ERROR;this.errorText="parse error - "+JSON.stringify(g);return}b("ErrorUtils").applyWithGuard(this.onJSONSafe,this)}}};c.prototype.$5=function(a){"use strict";var b=this.xhr&&this.xhr.readyState||0;this.status==null&&b>=2&&this.$6();!this.errorType&&this.status!=null&&((b===3&&this.streamMode||b===4)&&a(function(){return this.$7()}.bind(this)));(this.errorType||b===4)&&(this.$4=Date.now()-this.$3,a.last(function(){this.errorType?this.onErrorSafe():this.onSuccessSafe(),i(this)}.bind(this)))};window.addEventListener&&b("UserAgent_DEPRECATED").firefox()&&window.addEventListener("keydown",function(event){event.keyCode===b("Keys").ESC&&event.prevent()},!1);window.attachEvent&&window.attachEvent("onunload",a);e.exports=c}),null);
__d("ChannelSubdomain",["Event","JSLogger","Run","LogHistory","clearTimeout","setTimeoutAcrossTransitions","WebStorage"],(function(a,b,c,d,e,f){__p&&__p();var g=b("LogHistory").getInstance("channel"),h=b("JSLogger").create("channel"),i="channel_sub:",j=7,k=100*1e3,l=null,m=null;function n(){var a=b("WebStorage").getLocalStorage();m&&(b("clearTimeout")(m),m=null);a&&l!=null&&a.removeItem(i+l);l=null}function a(a,c,d){__p&&__p();d===void 0&&(d=!1);a=(a-1)*j;d&&(m&&b("clearTimeout")(m),l=m=null);c==null&&(c=Math.floor(Math.random()*a));if(l==null){var e=b("WebStorage").getLocalStorage();if(e){d=[];for(var f=0;f<e.length;f++){var o=e.key(f);if(o!=null&&o.indexOf(i)===0){var p=parseInt(o.substr(i.length),10);d[p]=parseInt(e.getItem(o),10)}}p=Date.now()-k;for(var o=0;o<a;o++){f=(o+c)%a;if(!d[f]||d[f]<p){l=f;break}}if(l!=null){f=function a(){if(l==null)return;try{e.setItem(i+l,Date.now().toString())}catch(a){g.warn("subdomain set failed",a.message)}m=b("setTimeoutAcrossTransitions")(a,k/2)};f()}else g.warn("no channel subdomain",d),h.error("subdomain_overflow");typeof window.onpageshow!=="undefined"?b("Event").listen(window,"pagehide",n):b("Run").onUnload(n)}else l=c}return l==null?null:l%j}e.exports={allocate:a,clear:n}}),null);
__d("ChatproxyClientErrorsTypedLogger",["Banzai","GeneratedLoggerUtils","nullthrows"],(function(a,b,c,d,e,f){"use strict";__p&&__p();function a(){this.clear()}a.prototype.log=function(){b("GeneratedLoggerUtils").log("logger:ChatproxyClientErrorsLoggerConfig",this.$1,b("Banzai").BASIC)};a.prototype.logVital=function(){b("GeneratedLoggerUtils").log("logger:ChatproxyClientErrorsLoggerConfig",this.$1,b("Banzai").VITAL)};a.prototype.logImmediately=function(){b("GeneratedLoggerUtils").log("logger:ChatproxyClientErrorsLoggerConfig",this.$1,{signal:!0})};a.prototype.clear=function(){this.$1={};return this};a.prototype.getData=function(){return babelHelpers["extends"]({},this.$1)};a.prototype.updateData=function(a){this.$1=babelHelpers["extends"]({},this.$1,a);return this};a.prototype.setAppVersion=function(a){this.$1.app_version=a;return this};a.prototype.setBatchSize=function(a){this.$1.batch_size=a;return this};a.prototype.setErrorMessage=function(a){this.$1.error_message=a;return this};a.prototype.setErrorReason=function(a){this.$1.error_reason=a;return this};a.prototype.setErrorText=function(a){this.$1.error_text=a;return this};a.prototype.setJsEventTimeMs=function(a){this.$1.js_event_time_ms=a;return this};a.prototype.setMultiViewSubscription=function(a){this.$1.multi_view_subscription=a;return this};a.prototype.setRequestID=function(a){this.$1.request_id=a;return this};a.prototype.setResponseHeaders=function(a){this.$1.response_headers=a;return this};a.prototype.setSessionID=function(a){this.$1.session_id=a;return this};a.prototype.setSessionIDStr=function(a){this.$1.session_id_str=a;return this};a.prototype.setStatusCode=function(a){this.$1.status_code=a;return this};a.prototype.setSubscriberID=function(a){this.$1.subscriber_id=a;return this};a.prototype.setTopicPrefixes=function(a){this.$1.topic_prefixes=b("GeneratedLoggerUtils").serializeVector(a);return this};a.prototype.setURL=function(a){this.$1.url=a;return this};a.prototype.setXhrReadyState=function(a){this.$1.xhr_ready_state=a;return this};a.prototype.setXhrStatus=function(a){this.$1.xhr_status=a;return this};c={app_version:!0,batch_size:!0,error_message:!0,error_reason:!0,error_text:!0,js_event_time_ms:!0,multi_view_subscription:!0,request_id:!0,response_headers:!0,session_id:!0,session_id_str:!0,status_code:!0,subscriber_id:!0,topic_prefixes:!0,url:!0,xhr_ready_state:!0,xhr_status:!0};e.exports=a}),null);
__d("DocRPC",["ErrorUtils","FBLogger"],(function(a,b,c,d,e,f){__p&&__p();var g={_apis:{},_dispatch:function(a){__p&&__p();var c;try{a=JSON.parse(a)}catch(b){throw new Error('DocRPC unparsable dispatch: "'+a+'"')}if(Object.prototype.hasOwnProperty.call(g._apis,a.api)){var d=g._apis[a.api];d[a.method]&&(c=b("ErrorUtils").applyWithGuard(d[a.method],d,a.args))}c===undefined&&(c=null);return JSON.stringify(c)},publish:function(a,b){g._apis[b]=a},proxy:function(a,c,d){__p&&__p();var e={};d.forEach(function(d){__p&&__p();e[d]=function(){__p&&__p();var e={api:c,method:d,args:Array.prototype.slice.call(arguments)},f;try{if(a.closed)throw new Error("DocRPC window closed");f=a.DocRPC._dispatch(JSON.stringify(e))}catch(a){b("FBLogger")("doc_rpc").catching(a).warn("Encountered an error duing proxy call");return}if(typeof f==="string")try{f=JSON.parse(f)}catch(a){b("FBLogger")("doc_rpc").catching(a).mustfix("DocRPC %s.%s unparsable return: %s",c,d,f);throw new Error("DocRPC "+c+"."+d+' unparsable return: "'+f+'"')}return f}});return e}};e.exports=a.DocRPC=g}),null);
__d("ChannelTransport",["AjaxRequest","BanzaiODS","ChannelConstants","ChatproxyClientErrorsTypedLogger","DocRPC","LogHistory","TimeSlice","URI","bind","clearTimeout","setTimeoutAcrossTransitions"],(function(a,b,c,d,e,f){__p&&__p();var g="BROWSER_REFUSED_TO_GET_FAILURE_REASON_HEADER",h=b("LogHistory").getInstance("channel");function i(a){__p&&__p();var c=new(b("ChatproxyClientErrorsTypedLogger"))();c.setStatusCode(a.status);if(a.xhr!=null){var d;try{d=a.xhr.getResponseHeader("x-fb-chat-failure-reason")}catch(a){d=g}d&&c.setErrorReason(d)}c.setErrorMessage(a.errorType);a.uri!==undefined&&c.setURL(a.uri.getPath());c.log()}function j(){return(1048576*Math.random()|0).toString(36)}function k(a){return a!==null&&a!==undefined&&!isNaN(a)&&isFinite(a)&&0<=a&&a<=6}function l(a,c){var d="";k(a.subdomain)&&(d=a.subdomain+"-");var e=a.host;e=e===null||e===undefined?"edge-chat":a.host;c=new(b("URI"))(c).setDomain(d+e+"."+a.domain).setPort(a.port).setSecure(new(b("URI"))(window.location.href).isSecure());return c}function m(a){__p&&__p();var c={partition:a.partition,cb:j(),failure:a.pingFailuresOnSubdomain};a.sticky_token&&(c.sticky_token=a.sticky_token);a.sticky_pool&&(c.sticky_pool=a.sticky_pool);c=l(a,"/p").setQueryData(c);h.log("start_p",{uri:c.toString()});var d=new(b("AjaxRequest"))("GET",c);b("AjaxRequest").supportsCORS()&&(d.xhr.withCredentials=!0);var e=function(b){h.log("finish_p",{xhr:b.toJSON?b.toJSON():b,subdomain:a.subdomain,fullHost:a.fullHost})};d.onError=function(c){b("BanzaiODS").bumpEntityKey("ChannelTransport","sendP.error");i(d);e(c);if(a.subdomain===null)return;k(a.subdomain)&&(a.pingFailuresOnSubdomain++,a.subdomain++,a.subdomain>6&&(a.subdomain=0))};d.timeout=a.P_TIMEOUT;d.onSuccess=function(a){b("BanzaiODS").bumpEntityKey("ChannelTransport","sendP.success"),e(a)};d.send()}function n(a,c,d){__p&&__p();var e=new Image(),f=0,g=function(a){e.abort();return a?c():d()};e.onload=b("TimeSlice").guard(function(){h.log("ping_ok",{duration:Date.now()-f}),b("BanzaiODS").bumpEntityKey("ChannelTransport","sendPing.success"),g(!0)},"ChannelTransport image.onload");e.onerror=b("TimeSlice").guard(function(){m(a),b("BanzaiODS").bumpEntityKey("ChannelTransport","sendPing.error"),i(e),g(!1)},"ChannelTransport image.onerror");var k=b("setTimeoutAcrossTransitions")(e.onerror,1e4);e.abort=function(){k&&(b("clearTimeout")(k),k=null),e.onload=e.onerror=null};var n={partition:a.partition,cb:j()};a.sticky_token&&(n.sticky_token=a.sticky_token);a.sticky_pool&&(n.sticky_pool=a.sticky_pool);a.lastRequestErrorReason&&(n.reason=a.lastRequestErrorReason,a.lastRequestErrorReason=null);a.uid&&a.viewerUid&&(n.uid=a.uid,n.viewer_uid=a.viewerUid);f=Date.now();e.src=l(a,"/ajax/chatproxy-ping").setQueryData(n);return e}function a(a,c){__p&&__p();var d={channel:a.user_channel,partition:a.partition,clientid:a.sessionID,cb:j(),cap:0,uid:a.uid,viewer_uid:a.viewerUid};a.sticky_token&&(d.sticky_token=a.sticky_token);a.sticky_pool&&(d.sticky_pool=a.sticky_pool);a.profile&&(d.profile=a.profile);a.capabilities&&(d.cap=a.capabilities);d.id=c;c=l(a,"/add_bud").setQueryData(d);var e=new(b("AjaxRequest"))("GET",c);b("AjaxRequest").supportsCORS()&&(e.xhr.withCredentials=!0);e.onError=function(a){b("BanzaiODS").bumpEntityKey("ChannelTransport","sendAdditionalBuddy.error"),h.warn("add_buddy_error"),i(e)};e.onSuccess=function(a){b("BanzaiODS").bumpEntityKey("ChannelTransport","sendAdditionalBuddy.success"),h.log("add_buddy_ok")};e.timeout=a.P_TIMEOUT;e.send()}function c(a){__p&&__p();var c={channel:a.user_channel,partition:a.partition,clientid:a.sessionID,cb:j(),cap:0,uid:a.uid,viewer_uid:a.viewerUid};a.sticky_token&&(c.sticky_token=a.sticky_token);a.sticky_pool&&(c.sticky_pool=a.sticky_pool);a.is_offline||a.shouldSuppressPresence?c.state="offline":c.state="active";if(c.state===a.lastPresenceState)return;a.lastPresenceState=c.state;a.profile&&(c.profile=a.profile);a.capabilities&&(c.cap=a.capabilities);c=l(a,"/active_ping").setQueryData(c);var d=new(b("AjaxRequest"))("GET",c);b("AjaxRequest").supportsCORS()&&(d.xhr.withCredentials=!0);d.onError=function(a){b("BanzaiODS").bumpEntityKey("ChannelTransport","sendActivePing.error"),h.warn("active_ping_error"),i(d)};d.onSuccess=function(a){b("BanzaiODS").bumpEntityKey("ChannelTransport","sendActivePing.success"),h.log("active_ping_ok")};d.timeout=a.P_TIMEOUT;d.send()}function o(a,c,d,e){__p&&__p();var f=new Date(),g=-1;a.userActive>0&&(g=(f-a.userActive)/1e3|0,g<0&&h.warn("idle_regression",{idleTime:g,now:f.getTime(),userActive:a.userActive}));f={channel:a.user_channel,seq:a.seq,partition:a.partition,clientid:a.sessionID,cb:j(),idle:g,qp:"y",cap:0};a.state.aiq&&(f.aiq=a.state.aiq);a.ready&&((a.seqTurSentAt==-1||a.seqTurSentAt==a.seq)&&(f.tur=a.timeUntilReady,f.qpmade=a.queueMade,a.seqTurSentAt=a.seq));f.pws=a.pws;a.sequenceId>0&&(f.isq=a.sequenceId);f.msgs_recv=a.estimatedReceived;a.uid&&a.viewerUid&&(f.uid=a.uid,f.viewer_uid=a.viewerUid);a.sticky_token?f.sticky_token=a.sticky_token:(f.request_batch=1,a.msgr_region&&(f.msgr_region=a.msgr_region));a.sticky_pool&&(f.sticky_pool=a.sticky_pool);"trace_id"in a&&(f.traceid=a.trace_id);a.is_offline||a.shouldSuppressPresence?f.state="offline":a.userActive>0&&g<60&&(f.state="active");a.lastPresenceState=f.state;a.streamingCapable&&(f.mode="stream",f.format="json");a.profile&&(f.profile=a.profile);a.capabilities&&(f.cap=a.capabilities);g=l(a,"/pull").setQueryData(f);f="GET";var k=new(b("AjaxRequest"))(f,g);b("AjaxRequest").supportsCORS()&&(k.xhr.withCredentials=!0);k.timeout=a.streamingCapable?a.STREAMING_TIMEOUT:a.LONGPOLL_TIMEOUT;k.onJSON=function(a){b("BanzaiODS").bumpEntityKey("ChannelTransport","sendPull.json"),c(a)};k.onSuccess=function(a){b("BanzaiODS").bumpEntityKey("ChannelTransport","sendPull.success"),d(a)};k.onError=function(){var c=this.status==12002&&this._time>=a.MIN_12002_TIMEOUT||this.status==504&&this._time>=a.MIN_504_TIMEOUT,f=c?d:e;c?b("BanzaiODS").bumpEntityKey("ChannelTransport","sendPull.success"):(b("BanzaiODS").bumpEntityKey("ChannelTransport","sendPull.error"),i(k));return f&&f.apply(this,arguments)};k.send();a.inStreaming=a.streamingCapable;return k}function p(a){this.manager=a,this.init&&this.init()}function d(a){p.apply(this,arguments)}Object.assign(d.prototype,{logName:"CORS",enterState:function(a,c){this._request&&(this._request.abort(),this._request=null);a=="init"&&b("setTimeoutAcrossTransitions")(b("bind")(this.manager,"exitState",{status:b("ChannelConstants").OK,stateId:c.stateId}),0);if(!/pull|ping/.test(a))return;var d=this.manager;a=="ping"?this._request=n(c,b("bind")(d,"exitState",{status:b("ChannelConstants").OK,stateId:c.stateId}),b("bind")(d,"exitState",{status:b("ChannelConstants").ERROR,stateId:c.stateId})):a=="pull"&&(this._request=o(c,b("bind")(d,"_processTransportData",c.stateId),b("bind")(d,"exitState",{status:b("ChannelConstants").OK,stateId:c.stateId}),b("bind")(d,"exitState",{status:b("ChannelConstants").ERROR,stateId:c.stateId})))}});function f(a){h.log("iframe_init_constructor"),p.apply(this,arguments),this._iframe=document.createElement("iframe"),this._iframe.style.display="none",document.body.appendChild(this._iframe),b("DocRPC").publish(this,"outerTransport")}Object.assign(f.prototype,{logName:"iframe",_initIframe:function(a){__p&&__p();h.log("iframe_init_start");window.onchanneliframeready=function(){h.log("iframe_resources");return a.resources};window.onchanneliframeloaded=function(){h.log("iframe_loaded")};if(a){this._iframeURI=l(a,a.path);if(a.resources){var c=this._iframeURI.getDomain();a.resources=a.resources.map(function(a){var d=new(b("URI"))(a);return d.getPath().startsWith("/intern/rsrc.php")&&d.getQueryData().origin!==undefined?d.addQueryData("origin",c).toString():a})}}else this._iframeURI="about:blank";this._iframeProxy=null;try{this._iframe.contentWindow.location.replace(this._iframeURI),h.log("iframe_uri_set")}catch(c){h.error("iframe_uri_set_error",c),this.exitState({status:b("ChannelConstants").ERROR,stateId:a.stateId},c+"")}},enterState:function(a,c){a=="init"?this._initIframe(c):/idle|ping|pull/.test(a)?this._iframeProxy?this._iframeProxy.enterState.apply(this._iframeProxy,arguments):a!="idle"&&this.exitState({status:b("ChannelConstants").ERROR,stateId:c.stateId},"iframe not yet loaded"):a=="shutdown"&&this._initIframe()},_processTransportData:function(){this.manager._processTransportData.apply(this.manager,arguments)},exitState:function(a){this.manager.state=="init"&&a.status==b("ChannelConstants").OK&&(this._iframeProxy=b("DocRPC").proxy(this._iframe.contentWindow,"innerTransport",["enterState"],(this._iframeURI+"").replace(/iframe.*/,"")));if(/ping|pull/.test(this.manager.state)&&!this._iframeProxy)return;this.manager.exitState.apply(this.manager,arguments)}});function q(){this.init=this.init.bind(this),p.apply(this,arguments)}Object.assign(q.prototype,{logName:"iframe(inner)",init:function(){b("DocRPC").publish(this,"innerTransport");try{var a=b("DocRPC").proxy(window.parent,"outerTransport",["_processTransportData","exitState"],top.DocRPC.origin);Object.assign(this,a);this.exitState({status:b("ChannelConstants").OK,stateId:1e6})}catch(a){h.error("iframe_inner_init_error",a)}},enterState:function(a,c){this._request&&(this._request.abort(),this._request=null),a=="ping"?this._request=n(c,b("bind")(this,"exitState",{status:b("ChannelConstants").OK,stateId:c.stateId}),b("bind")(this,"exitState",{status:b("ChannelConstants").ERROR,stateId:c.stateId})):a=="pull"&&(this._request=o(c,b("bind")(this,"_processTransportData",c.stateId),b("bind")(this,"exitState",{status:b("ChannelConstants").OK,stateId:c.stateId}),b("bind")(this,"exitState",{status:b("ChannelConstants").ERROR,stateId:c.stateId})))}});e.exports={isSubdomain:k,getURI:l,Transport:p,CORSTransport:d,IframeTransport:f,IframeInnerTransport:q,sendActivePing:c,sendAdditionalBuddyRequest:a}}),null);
__d("ChannelTransportDataLogger",["Arbiter","JSLogger","MercuryLoggingHelper"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g=[],h=10,i=function(a){return a.map(function(a){var c=a;(a.message||a.delta&&a.delta.body)&&(c=babelHelpers["extends"]({},a),a.message&&(c.message=b("MercuryLoggingHelper").obfuscateMessage(a.message)),a.delta&&a.delta.body&&(c.delta=b("MercuryLoggingHelper").obfuscateMessage(a.delta)));return c})};a={log:function(a){var b={t:a.t,seq:a.seq};a.ms&&(b.ms=i(a.ms));g.push(b);g.length>h&&g.shift()}};b("Arbiter").subscribe(b("JSLogger").DUMP_EVENT,function(a,b){b.channelTransportLog=g});e.exports=a}),null);
__d("ChatProxyConnectionState",[],(function(a,b,c,d,e,f){"use strict";__p&&__p();function a(){this.auxiliaryIrisQueues={},this.aiq=null}a.prototype.subscribeIrisQueue=function(a,b){this.auxiliaryIrisQueues[a]=b,this.updateCaches()};a.prototype.unsubscribeIrisQueue=function(a){delete this.auxiliaryIrisQueues[a],this.updateCaches()};a.prototype.updateCaches=function(){var a=[];for(var b in this.auxiliaryIrisQueues)Object.prototype.hasOwnProperty.call(this.auxiliaryIrisQueues,b)&&(a.push(b),a.push(this.auxiliaryIrisQueues[b]));a.length===0?this.aiq=null:this.aiq=a.join(",")};e.exports=a}),null);
__d("FBAjaxRequest",["AjaxError","AjaxRequest","getAsyncParams"],(function(a,b,c,d,e,f){__p&&__p();var g;c=babelHelpers.inherits(a,b("AjaxRequest"));g=c&&c.prototype;function a(a,c,d){"use strict";d=babelHelpers["extends"]({},b("getAsyncParams")(a),d);g.constructor.call(this,a,c,d);this.$FBAjaxRequest1=d;this.streamMode=!1}a.prototype.onJSONSafe=function(){"use strict";this.json&&(this.json.error&&(this.errorType=b("AjaxError").SERVER_ERROR,this.errorText="AsyncResponse error: "+this.json.error),this.json=this.json.payload),g.onJSONSafe.call(this)};a.prototype.send=function(a){"use strict";g.send.call(this,babelHelpers["extends"]({},a,this.$FBAjaxRequest1))};e.exports=a}),null);
__d("CollabMinimumChromeVersion",[],(function(a,b,c,d,e,f){e.exports=Object.freeze({SCREEN_SHARE_CALL:65,VIDEO_CALL:48})}),null);
__d("FBRTCSupport",["ChannelConstants","CollabMinimumChromeVersion","RTCConfig","UserAgent","WorkplaceChatHelper"],(function(a,b,c,d,e,f){__p&&__p();var g={isWebrtcSupported:function(){return b("UserAgent").isBrowser("Chrome >= 28")||b("UserAgent").isBrowser("Firefox >= 25")||b("UserAgent").isBrowser("Edge >= 15.15042")||b("UserAgent").isBrowser("Opera >= 20")},isGroupCallWebtrcSupported:function(){return b("UserAgent").isBrowser("Chrome >= 28")||b("UserAgent").isBrowser("Opera >= 20")},isCollabSupported:function(){return g.isWebrtcSupported()&&(!!b("RTCConfig").CollabWhitelistedBrowserGK||b("UserAgent").isBrowser("Chrome >= "+b("CollabMinimumChromeVersion").VIDEO_CALL))},isMobileDevice:function(){return b("UserAgent").isPlatform("Android")||b("UserAgent").isPlatform("iOS")},isVideoFilterEffectSupported:function(){return!g.isMobileDevice()&&(b("UserAgent").isBrowser("Chrome >= 51")||b("UserAgent").isBrowser("Opera >= 36"))},getCapabilities:function(){var a=b("ChannelConstants").CAPABILITY_VOIP_INTEROP;b("WorkplaceChatHelper").isDesktopChatApp()&&(a|=b("ChannelConstants").CAPABILITY_ACTIVE_ON_DESKTOP_APP);return a},videoEscalationByUnmuteWorkaround:function(){return b("UserAgent").isBrowser("Firefox < 60")||b("UserAgent").isBrowser("Edge")}};e.exports=g}),null);
__d("MovingStat",[],(function(a,b,c,d,e,f){__p&&__p();function a(a){"use strict";this.$1=a>0?a:6e4,this.$2=0,this.$3=0,this.$5={t:new Date(),count:0,v:0},this.$4=this.$5}a.prototype.add=function(a){"use strict";__p&&__p();this.$2+=a;this.$3++;var b=new Date();if(b-this.$5.t<1e3){this.$5.v+=a;this.$5.count++;return}this.$5.next={t:b,v:a,count:1};this.$5=this.$5.next;this.$6()};a.prototype.tally=function(a){a===void 0&&(a=1e3);this.$6();return{sum:this.$2,count:this.$3,timeAverage:this.$2*a/this.$1}};a.prototype.$6=function(){"use strict";var a=new Date()-this.$1;while(this.$4&&this.$4.next&&this.$4.t<a)this.$2-=this.$4.v,this.$3-=this.$4.count,this.$4=this.$4.next};e.exports=a}),null);
__d("Dcode",[],(function(a,b,c,d,e,f){__p&&__p();var g,h={},i={_:"%",A:"%2",B:"000",C:"%7d",D:"%7b%22",E:"%2c%22",F:"%22%3a",G:"%2c%22ut%22%3a1",H:"%2c%22bls%22%3a",I:"%2c%22n%22%3a%22%",J:"%22%3a%7b%22i%22%3a0%7d",K:"%2c%22pt%22%3a0%2c%22vis%22%3a",L:"%2c%22ch%22%3a%7b%22h%22%3a%22",M:"%7b%22v%22%3a2%2c%22time%22%3a1",N:".channel%22%2c%22sub%22%3a%5b",O:"%2c%22sb%22%3a1%2c%22t%22%3a%5b",P:"%2c%22ud%22%3a100%2c%22lc%22%3a0",Q:"%5d%2c%22f%22%3anull%2c%22uct%22%3a",R:".channel%22%2c%22sub%22%3a%5b1%5d",S:"%22%2c%22m%22%3a0%7d%2c%7b%22i%22%3a",T:"%2c%22blc%22%3a1%2c%22snd%22%3a1%2c%22ct%22%3a",U:"%2c%22blc%22%3a0%2c%22snd%22%3a1%2c%22ct%22%3a",V:"%2c%22blc%22%3a0%2c%22snd%22%3a0%2c%22ct%22%3a",W:"%2c%22s%22%3a0%2c%22blo%22%3a0%7d%2c%22bl%22%3a%7b%22ac%22%3a",X:"%2c%22ri%22%3a0%7d%2c%22state%22%3a%7b%22p%22%3a0%2c%22ut%22%3a1",Y:"%2c%22pt%22%3a0%2c%22vis%22%3a1%2c%22bls%22%3a0%2c%22blc%22%3a0%2c%22snd%22%3a1%2c%22ct%22%3a",Z:"%2c%22sb%22%3a1%2c%22t%22%3a%5b%5d%2c%22f%22%3anull%2c%22uct%22%3a0%2c%22s%22%3a0%2c%22blo%22%3a0%7d%2c%22bl%22%3a%7b%22ac%22%3a"};(function(){var a=[];for(var b in i)h[i[b]]=b,a.push(i[b]);a.reverse();g=new RegExp(a.join("|"),"g")})();a={encode:function(a){return encodeURIComponent(a).replace(/([_A-Z])|%../g,function(a,b){return b?"%"+b.charCodeAt(0).toString(16):a}).toLowerCase().replace(g,function(a){return h[a]})},decode:function(a){return decodeURIComponent(a.replace(/[_A-Z]/g,function(a){return i[a]}))}};e.exports=a}),null);
__d("PresenceCookieManager",["Cookie","CurrentUser","Dcode","ErrorUtils","JSLogger","PresenceInitialData","PresenceUtil","WebStorage","WorkModeConfig"],(function(a,b,c,d,e,f){__p&&__p();var g=b("PresenceInitialData").cookieVersion,h="presence",i={},j=null,k=null,l=b("JSLogger").create("presence_cookie");function m(a){var c=b("Cookie").get(h)||"";if(c.length===0)return null;return c[0]!==a?null:c.substring(1)}function n(a,c){b("Cookie").set(h,a+c)}function o(){return!(b("PresenceInitialData").useWebStorage||!1)?null:b("WebStorage").getSessionStorage()}function p(){var a=o();a=a!=null?a.getItem(h):null;return a!=null?a.substring(1):null}function q(a){var b=o();if(b==null)return!1;b.setItem(h,"E"+a);return!0}function r(){var a=p();return a!=null?a:m("E")}function s(a){__p&&__p();a=a.state;if(a==null)return"";var c=m("S")||"",d=b("WorkModeConfig").is_work_user?"w":"f";a=b("WorkModeConfig").is_work_user?a.t3w:a.t3;a=a!=null?a.length>0:!1;var e=c.indexOf(d)!==-1;e&&!a&&(c=c.replace(d,""));!e&&a&&(c+=d);return c}function t(a,b){var c=q(a);c?n("S",b):(a.length>1024&&l.warn("big_cookie",a.length),n("E",a))}function u(){__p&&__p();try{var a=r();j!==a&&(j=a,k=null,a&&(a=b("Dcode").decode(a),k=JSON.parse(a)));if(k){if(k.user&&k.user!==b("CurrentUser").getID())return null;return k.v!==g?null:k}}catch(a){l.warn("getcookie_error",a)}return null}function v(){return{v:g,time:w(),user:b("CurrentUser").getID()}}function w(){return parseInt(Date.now()/1e3,10)}function x(a){var c=b("Dcode").encode(JSON.stringify(a));b("PresenceUtil").hasUserCookie()&&t(c,s(a))}var y={register:function(a,b){i[a]=b},store:function(){__p&&__p();var a=u();if(a&&a.v&&g<a.v){l.debug("stale_cookie",g);return}var c=v();for(var d in i)c[d]=b("ErrorUtils").applyWithGuard(i[d],i,[a&&a[d]],function(a){a.presence_subcookie=d});x(c)},clear:function(){var a=y.getSubCookie("state");b("Cookie").clear(h);var c=b("WebStorage").getSessionStorage();c!=null&&c.removeItem(h);if(a){c=v();c.state=a;x(c)}},getSubCookie:function(a){var b=u();return!b?null:b[a]}};e.exports=y}),null);
__d("FantaConst",[],(function(a,b,c,d,e,f){"use strict";var g={DEFAULT_ALLOWED_RAISED_TABS:2,DEFAULT_MESSAGE_COUNT:10,cookieIDs:{PERSONAL_COOKIE_ID:"t3",PERSONAL_FOCUS_COOKIE_ID:"lm3",PERSONAL_TIME_COOKIE_ID:"utc3",WORK_COOKIE_ID:"t3w",WORK_FOCUS_COOKIE_ID:"lm3w",WORK_TIME_COOKIE_ID:"utc3w"},getCookieIDs:function(){return[g.cookieIDs.PERSONAL_COOKIE_ID,g.cookieIDs.PERSONAL_FOCUS_COOKIE_ID,g.cookieIDs.PERSONAL_TIME_COOKIE_ID,g.cookieIDs.WORK_COOKIE_ID,g.cookieIDs.WORK_FOCUS_COOKIE_ID,g.cookieIDs.WORK_TIME_COOKIE_ID]}};e.exports=g}),null);
__d("PresenceState",["Arbiter","ErrorUtils","FantaConst","JSLogger","PresenceCookieManager","PresenceInitialData","debounceAcrossTransitions","setIntervalAcrossTransitions"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g=b("PresenceInitialData").cookiePollInterval||2e3,h=b("PresenceInitialData").shouldSuppress||!1,i=[],j=[],k=null,l=null,m=0,n=null,o=0,p=["sb2","tr","tw","at","wml"].concat(b("FantaConst").getCookieIDs()),q=b("JSLogger").create("presence_state");function r(){return b("PresenceCookieManager").getSubCookie("state")}function s(){m=Date.now(),b("PresenceCookieManager").store(),w(l)}var t=b("debounceAcrossTransitions")(s,0);function u(a){(a==undefined||isNaN(a)||a==Number.POSITIVE_INFINITY||a==Number.NEGATIVE_INFINITY)&&(a=0);return a}function v(a){var c={};a&&(p.forEach(function(b){a&&a[b]&&(c[b]=a[b])}),m<a.ut&&q.error("new_cookie",{cookie_time:a.ut,local_time:m}));c.ut=m;for(var d=0,e=i.length;d<e;d++)b("ErrorUtils").applyWithGuard(i[d],null,[c]);l=c;return l}function w(a){o++;m=u(a&&a.ut);k||(k=b("setIntervalAcrossTransitions")(z,g));l=a;n===null&&(n=a);for(var c=0,d=j.length;c<d;c++)b("ErrorUtils").applyWithGuard(j[c],null,[a]);o--}function x(a){if(a&&a.ut)if(m<a.ut)return!0;else a.ut<m&&q.error("old_cookie",{cookie_time:a.ut,local_time:m});return!1}function y(){var a=r();x(a)&&(l=a);return l}function z(){var a=r();x(a)&&w(a)}b("PresenceCookieManager").register("state",v);b("Arbiter").subscribe(b("JSLogger").DUMP_EVENT,function(a,b){b.presence_state={initial:babelHelpers["extends"]({},n),state:babelHelpers["extends"]({},l),update_time:m,sync_paused:o,poll_time:g}});(function(){var a=y();if(a)w(a);else{q.debug("no_cookie_initial");w(v());return}})();a={doSync:function(a){if(o)return;a?s():t()},registerStateStorer:function(a){i.push(a)},registerStateLoader:function(a){j.push(a)},get:function(){return y()},getInitial:function(){return n},shouldSuppress:function(){return h},verifyNumber:u};e.exports=a}),null);
__d("RTISession",["invariant","AjaxRequest","BanzaiODS","ChatproxyClientErrorsTypedLogger","ErrorUtils","URI"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();function a(a,b,c,d,e,f,g,h,i,j){this.domain=a,this.topLevelDomain=b,this.port=c,this.edgePoolName=d,this.stickyToken=e,this.loggedInId=f,this.accountId=g,this.clientProfile=h!=null?h:"desktop",this.clientId=i,this.capabilities=j}a.prototype.issueRequest=function(a,c,d,e,f){__p&&__p();var h=this.domain+"."+this.topLevelDomain,i=(1048576*Math.random()|0).toString(36);i={cb:i,sticky_token:this.stickyToken,uid:this.loggedInId,viewer_uid:this.accountId,sticky_pool:this.edgePoolName,profile:this.clientProfile,clientid:this.clientId,cap:this.capabilities};for(var j in i)c[j]&&g(0,undefined);Object.assign(i,c);c=new(b("URI"))(a).setDomain(h).setPort(this.port).setSecure(new(b("URI"))(window.location.href).isSecure()).setQueryData(i);a=d?"POST":"GET";var k=new(b("AjaxRequest"))(a,c);k.timeout=f!=null?f*1e3:3e4;k.streamMode=!1;k.xhr&&(k.xhr.withCredentials=!0);var l={};k.onSuccess=function(){b("BanzaiODS").bumpEntityKey("RTISession","request.success")};k.onJSON=function(){l.data=k.json,l.error=null,b("ErrorUtils").applyWithGuard(e,this,[l])}.bind(this);k.onError=function(){__p&&__p();var a=new Set(),c=null;if(d.subscriptions!=null&&Array.isArray(d.subscriptions)){c=d.subscriptions.length;for(var f=0;f<d.subscriptions.length;f++){var g=d.subscriptions[f].topic.split("/");g.pop();a.add(g.join("/"))}}l.data=null;l.error=k.errorType||"error";b("BanzaiODS").bumpEntityKey("RTISession","request.error");this.$1(k,a,c);b("ErrorUtils").applyWithGuard(e,this,[l])}.bind(this);k.send(JSON.stringify(d));b("BanzaiODS").bumpEntityKey("RTISession","request.attempt")};a.prototype.$1=function(a,c,d){__p&&__p();var e=new(b("ChatproxyClientErrorsTypedLogger"))();e.setStatusCode(a.status);if(a.xhr!=null){var f=a.xhr.getResponseHeader("x-fb-chat-failure-reason");f&&e.setErrorReason(f)}e.setSubscriberID(this.loggedInId);e.setSessionIDStr(this.clientId);e.setErrorMessage(a.errorType);e.setErrorText(a.errorText);e.setTopicPrefixes(c);e.setJsEventTimeMs(Math.floor(Date.now()/1e3));d!=null&&e.setBatchSize(d);a.uri&&e.setURL(a.uri.getPath());e.log()};e.exports=a}),null);
__d("ChannelManager",["errorCode","Promise","AjaxError","AjaxRequest","Arbiter","AsyncRequest","BanzaiODS","ChannelClientID","ChannelConstants","ChannelInitialData","ChannelSubdomain","ChannelTransport","ChannelTransportDataLogger","ChatProxyConnectionState","ChatReliabilityInstrumentation","ChatVisibility","DTSG","Env","FantailLogger","FBAjaxRequest","FBRTCSupport","ISB","JSLogger","LogHistory","MovingStat","PresenceCookieManager","PresenceState","PresenceUtil","Random","RTISession","SystemEvents","URI","UserActivity","clearTimeout","emptyFunction","requestAnimationFrameAcrossTransitions","setIntervalAcrossTransitions","setTimeoutAcrossTransitions"],(function(a,b,c,d,e,f,g){__p&&__p();var h,i=b("JSLogger").create("channel"),j=b("LogHistory").getInstance("channel_manager"),k=null,l=b("emptyFunction"),m=new(b("Promise"))(function(a,b){l=a});function a(a){k=a}var n={idle:{ok:"init!"},init:{ok:"pull!",error:"reconnect",sys_online:"init",sys_timetravel:"init"},pull:{ok:"pull!",error:"ping",error_missing:"pull",error_msg_type:"pull",refresh_0:"reconnect",refresh_110:"reconnect",refresh_111:"reconnect",refresh_112:"pull",refresh_113:"pull",refresh_117:"reconnect"},ping:{ok:"pull!",error:"ping",error_stale:"reconnect!"},reconnect:{ok:"init!",error:"reconnect",sys_online:"reconnect",sys_timetravel:"reconnect"},shutdown:{},_all:{error_max:"shutdown!",error_shutdown:"shutdown!",sys_owner:"reconnect",sys_nonowner:"idle!",sys_online:"ping",sys_offline:"idle!",sys_timetravel:"ping"}},o={state:new(b("ChatProxyConnectionState"))(),userActive:Date.now(),created:Date.now(),ready:!1,seqTurSentAt:-1,queueMade:"",sequenceId:0,lastPresenceState:null,lastRequestErrorReason:null,seq:0,pingFailuresOnSubdomain:0,pws:"fresh",estimatedReceived:0,sessionID:b("ChannelClientID").getID(),capabilities:b("FBRTCSupport").getCapabilities(),streamingCapable:!1,inStreaming:!1,shouldSuppressPresence:b("PresenceState").shouldSuppress(),LONGPOLL_TIMEOUT:6e4,STREAMING_TIMEOUT:6e4,P_TIMEOUT:3e4,IFRAME_LOAD_TIMEOUT:3e4,MIN_RETRY_INTERVAL:5e3,MAX_RETRY_INTERVAL:32e4,MIN_12002_TIMEOUT:9e3,MIN_504_TIMEOUT:2e4,STALL_THRESHOLD:18e4,JUMPSTART_THRESHOLD:9e4,MIN_INIT_PROBE_DELAY:3e3,INIT_PROBE_DELAY_RANDOMIZE_RANGE:12e3,CHANNEL_PROXY_REPORTING_MIN_INTERVAL:1e4,PROBE_DELAY:6e4,PROBE_HEARTBEATS_INTERVAL_LOW:1e3,PROBE_HEARTBEATS_INTERVAL_HIGH:5e3,STREAMING_EXIT_STATE_ON_CONTINUE:!1},p=1,q={},r=0;function s(){return b("AsyncRequest").lastSuccessTime?Math.round((Date.now()-b("AsyncRequest").lastSuccessTime)/1e3):-1}function t(){var a={};h.getConfig("host")&&(a[h.getConfig("user_channel")]=h.getConfig("seq",0));return a}function u(){__p&&__p();var a=Date.now(),c=Date.now(),d={total:0},e="idle",f=!1;b("SystemEvents").subscribe([b("SystemEvents").USER,b("SystemEvents").ONLINE,b("SystemEvents").TIME_TRAVEL],function(a,d){__p&&__p();v(!0);c=null;h.lastPullTime=Date.now();var e;switch(a){case b("SystemEvents").USER:e=b("SystemEvents").isPageOwner()?b("ChannelConstants").SYS_OWNER:b("ChannelConstants").SYS_NONOWNER;break;case b("SystemEvents").ONLINE:e=d?b("ChannelConstants").SYS_ONLINE:b("ChannelConstants").SYS_OFFLINE;break;case b("SystemEvents").TIME_TRAVEL:if(o.skipTimeTravel)return;if(0<d){b("FantailLogger").warn(b("ChannelConstants").FANTAIL_SERVICE,"skipping time travel failure. %s",d);return}e=b("ChannelConstants").SYS_TIMETRAVEL;break}h.exitState({status:e,stateId:p})});var g=function(f,g){__p&&__p();var h=Date.now(),i=null;g?(a=h,i=g.nextState||g.state):i=e;b("SystemEvents").checkTimeTravel();if(c){g=Math.round((h-c)/1e3);g>0&&(d[e]=(d[e]||0)+g,d.total+=g)}e=i;c=h;f||(d.lastSuccessTime=s(),d.online=b("SystemEvents").isOnline(),j.log("rollup",JSON.stringify(d)))};b("Arbiter").subscribe(b("ChannelConstants").ON_ENTER_STATE,g);b("setIntervalAcrossTransitions")(g,6e4);b("Arbiter").subscribe(b("JSLogger").DUMP_EVENT,function(a,b){b.channelRollup=d});g=function(){__p&&__p();if(h.isShutdown()||h.shouldIdle())return;b("SystemEvents").checkTimeTravel();var c=Date.now()-(h.lastPullTime||b("Env").start);if(!f&&c>o.STALL_THRESHOLD){var d=s();j.error("stall",JSON.stringify({lastSuccessTime:d,rollupState:e}));b("ChatReliabilityInstrumentation").logCHANNEL_STALLED(c.toString());f=!0}d=Date.now()-a;h.state=="pull"&&d>o.JUMPSTART_THRESHOLD&&(a=null,j.warn("jumpstart",JSON.stringify({state:h.state,dormant:d})),b("Arbiter").inform(b("ChannelConstants").JUMPSTART,d),h.enterState("init"))};b("setIntervalAcrossTransitions")(g,5e3)}function v(a){a?(r=0,q={}):r++}function w(a,c){var d=!b("AjaxRequest").supportsCORS(),e=b("ChannelTransport").isSubdomain(o.subdomain);!e||d?o.fullHost=o.host:o.fullHost=o.subdomain+"-"+o.host;b("FantailLogger").info(b("ChannelConstants").FANTAIL_SERVICE,"received lb info: %s at seq: %s{%s} with ".concat("sticky: %s/%s, subdomain: %s, fullHost: %s, state: %s,").concat(" source: %s, args: %s"),o.sessionID,o.seq,o.sequenceId,o.sticky_token,o.sticky_pool,o.subdomain,o.fullHost,h.state,a,c)}h={state:"idle",nextState:null,proxyDown:!1,lastPullTime:Date.now(),lastReportOnMisguidedMsgTime:Date.now(),heartbeats:[],setTestCallback:a,backoff:!1,sessionRegistered:!1,init:function(a,c){__p&&__p();b("FantailLogger").info(b("ChannelConstants").FANTAIL_SERVICE,"initializing sessionid:%s at iris-seq:%s",o.sessionID,o.sequenceId);this.init=b("emptyFunction");b("Arbiter").subscribe(b("ChannelConstants").GET_RTI_SESSION_REQUEST,function(event,a){this.informCurrentSession()}.bind(this));b("Arbiter").subscribe(b("ChannelConstants").CONSOLE_LOG,function(a,b){!1});b("requestAnimationFrameAcrossTransitions")(function(){b("FantailLogger").info(b("ChannelConstants").FANTAIL_SERVICE,"using session id: %s at seq: %s {%s} with sticky: %s/%s",o.sessionID,o.seq,o.sequenceId,o.sticky_token,o.sticky_pool),b("UserActivity").subscribe(function(){var a=b("ChannelTransport").getURI(o,"/U");b("FantailLogger").info(b("ChannelConstants").FANTAIL_SERVICE,"user activity sessionid: %s at seq: %s/{%s} with sticky: %s/%s state: %s uri: %s",o.sessionID,o.seq,o.sequenceId,o.sticky_token,o.sticky_pool,h.state,a);h.state=="pull"&&(o.userActive=Date.now(),b("ChannelTransport").sendActivePing(o))}),b("Arbiter").subscribe(b("ChannelConstants").ENTITY_PRESENCE_ACTIVE_PING,function(a){a=b("ChannelTransport").getURI(o,"/U");b("FantailLogger").info(b("ChannelConstants").FANTAIL_SERVICE,"entity presence activity sessionid: %s at seq: %s/{%s} with sticky: %s/%s state: %s uri: %s",o.sessionID,o.seq,o.sequenceId,o.sticky_token,o.sticky_pool,h.state,a);h.state=="pull"&&(o.userActive=Date.now())})});b("PresenceCookieManager").register("ch",t);var d=this.getConfig("max_conn",2);o.subdomain=b("ChannelSubdomain").allocate(d);b("ChannelTransport").isSubdomain(o.subdomain)||(b("FantailLogger").info(b("ChannelConstants").FANTAIL_SERVICE,"invalid subdomain from ChannelSubdomain: %s",o.subdomain),o.subdomain=null);this._transportRate=new(b("MovingStat"))(3e4);var e=b("AjaxRequest").supportsCORS()?"CORSTransport":"IframeTransport";b("BanzaiODS").bumpEntityKey("ChannelManager","transport_chosen."+e);this.transport=new(b("ChannelTransport")[e])(this);l(this.transport);a&&this.enterState(a,c);b("requestAnimationFrameAcrossTransitions")(function(){b("Arbiter").subscribe(b("JSLogger").DUMP_EVENT,function(event,a){this._transportRate&&(a.transportRate=this._transportRate.tally(),a.transportType=e,a.transportVersion=2)}.bind(this)),u()}.bind(this));if(h.getConfig("fullHost")&&b("AjaxRequest").supportsCORS()){if(h.getConfig("tryStreaming")){d=o.MIN_INIT_PROBE_DELAY+b("Random").random()*o.INIT_PROBE_DELAY_RANDOMIZE_RANGE;b("setTimeoutAcrossTransitions")(this._probeTest,d)}if(h.getConfig("trySSEStreaming")){a=o.MIN_INIT_PROBE_DELAY+b("Random").random()*o.INIT_PROBE_DELAY_RANDOMIZE_RANGE;b("setTimeoutAcrossTransitions")(this._sseProbeTest,a)}}},configure:function(){for(var a=arguments.length,c=new Array(a),d=0;d<a;d++)c[d]=arguments[d];j.log("configure",JSON.stringify(c));c.forEach(function(a){return Object.assign(o,a)});w("reconnect",JSON.stringify(c));b("Arbiter").inform(b("ChannelConstants").ON_CONFIG,this)},getConfig:function(a,b){return Object.prototype.hasOwnProperty.call(o,a)?o[a]:b},getCompleteConfig:function(){return o},subscribeIrisQueue:function(a,c){o.state.subscribeIrisQueue(a,c),this.exitState({status:b("ChannelConstants").OK,stateId:p})},unsubscribeIrisQueue:function(a){o.state.unsubscribeIrisQueue(a)},informCurrentSession:function(){var a=null;this.sessionRegistered&&o&&o.fullHost&&o.sticky_token&&o.uid&&(a=new(b("RTISession"))(o.fullHost,o.domain,o.port,o.sticky_pool,o.sticky_token,o.uid,o.viewerUid,o.profile,o.sessionID,o.capabilities));b("Arbiter").inform(b("ChannelConstants").RTI_SESSION,a)},isShutdown:function(){return this.state=="shutdown"},shouldIdle:function(){return!(b("SystemEvents").isPageOwner()&&b("SystemEvents").isOnline())},_sendIframeError:function(a){a=new(b("AsyncRequest"))().setURI("/ajax/presence/reconnect.php").setData({reason:a,fb_dtsg:b("DTSG").getToken()}).setOption("suppressErrorHandlerWarning",!0).setOption("retries",1).setMethod("GET").setReadOnly(!0).setAllowCrossPageTransition(!0);a.specifiesWriteRequiredParams()&&a.send()},_getDelay:function(){var a=Math.min(o.MIN_RETRY_INTERVAL*Math.pow(2,Math.max(0,r-1)),o.MAX_RETRY_INTERVAL);this.proxyDown&&"proxy_down_delay_millis"in o&&(a=o.proxy_down_delay_millis);this.proxyDown=!1;return Math.floor(a*(1+Math.random()*.5))},resetDelay:function(){v(!0)},enterState:function(){this._inEnterState&&(j.warn("enterstate_recursion",JSON.stringify({state:this.state,args:arguments})),b("ChatReliabilityInstrumentation").logERROR("enterstate_recursion"));this._inEnterState=!0;try{this._enterState.apply(this,arguments),this._inEnterState=!1}catch(a){this._inEnterState=!1;throw a}},_enterState:function(a){__p&&__p();var c=this.backoff?this._getDelay():0;this.backoff=!1;if(this.isShutdown()){b("FantailLogger").warn(b("ChannelConstants").FANTAIL_SERVICE,"not executing state due to shutdown mode: %s",a);return}if(a!="idle!"&&this.shouldIdle()){b("FantailLogger").warn(b("ChannelConstants").FANTAIL_SERVICE,"forced idleness");return}p++;o.stateId=p;b("clearTimeout")(this._deferredTransition);this._deferredTransition=null;!this.transport?(m.done(function(a){return a.enterState("idle")}),b("ChatReliabilityInstrumentation").logERROR("called enterState "+a+" before transport init")):this.transport.enterState("idle");this.state="idle";this.nextState=null;if(/!$/.test(a)){if(this._transportRate){var d=this._transportRate.tally().timeAverage,e=h.getConfig("MAX_CHANNEL_STATES_PER_SEC",1);d>=e&&(this._throttled||(this._throttled=!0,j.warn("throttled","{}"),b("Arbiter").inform(b("ChannelConstants").THROTTLED,d)),i.bump("throttle"),c=1e3/e)}}else/#$/.test(a)||(c=this._getDelay());a=a.replace(/\W*$/,"");if(!n[a]){b("FantailLogger").error(b("ChannelConstants").FANTAIL_SERVICE,"invalid state: %s",a);throw new Error("invalid state:"+a)}var f=Array.from(arguments),g;if(c<=0){g={state:a};this._transportRate&&this._transportRate.add(1);this.state=a;var k=this["_enter_"+this.state];k&&(f.shift(),k.apply(this,f));/init|idle|pull|ping/.test(this.state)&&(o.streamingCapable&&/pull/.test(this.state)&&(this.heartbeats=[]),o.is_offline=!b("ChatVisibility").isOnline(),o.capabilities=b("FBRTCSupport").getCapabilities(),b("FantailLogger").info(b("ChannelConstants").FANTAIL_SERVICE,"entering transport state: %s",this.state),!this.transport?(m.done(function(a){return a.enterState(this.state,o)}.bind(this)),b("ChatReliabilityInstrumentation").logERROR("called enterState "+a+" before transport init")):this.transport.enterState(this.state,o),this.state=="ping"&&(g.url=b("ChannelTransport").getURI(o).toString(),g.port=o.port||"undefined"))}else this.state="idle",this.nextState=a,g={state:this.state,delay:c,nextState:a},f[0]=a+"#",this._deferredTransition=b("setTimeoutAcrossTransitions")(function(){this._deferredTransition=null,this.enterState.apply(this,f)}.bind(this),c);/pull/.test(a)&&(g.client_id=o.sessionID,g.streaming=o.inStreaming);b("Arbiter").inform(b("ChannelConstants").ON_ENTER_STATE,g)},exitState:function(a,c){__p&&__p();var d=a.stateId,e=a.status;if(this.isShutdown()||d<p)return;var f=this.state,g=Array.from(arguments);g[0]=a.status;var h={state:f,status:e};/pull/.test(f)&&(h.client_id=o.sessionID,h.streaming=o.inStreaming);/ping/.test(f)&&e!=b("ChannelConstants").OK&&(h.url=b("ChannelTransport").getURI(o).toString());this.nextState&&(h.nextState=this.nextState);c&&c.errorType?(o.lastRequestErrorReason=c.errorType,h.xhr=c.toJSON?c.toJSON():c,c.errorType==b("AjaxError").SERVICE_UNAVAILABLE&&(b("FantailLogger").error(b("ChannelConstants").FANTAIL_SERVICE,"got 5xx http status code, setting long delay"),this.proxyDown=!0),delete h.xhr.json):e!=b("ChannelConstants").OK&&(o.lastRequestErrorReason=e);c&&c.json&&(c.json.t&&(h.t=c.json.t),c.json.reason&&(h.reason=c.json.reason),c.json.seq&&(h.seq=c.json.seq));b("Arbiter").inform(b("ChannelConstants").ON_EXIT_STATE,h);var i=this["_exit_"+f];i&&(e=i.apply(this,g)||e);e!=b("ChannelConstants").OK&&(v(),q[f]=(q[f]||0)+1);var k=n[this.nextState||f][e]||n._all[e],l=k&&k.replace(/!*$/,"");l||(j.error("terminal_transition",JSON.stringify(h)),this._shutdownHint=b("ChannelConstants").HINT_INVALID_STATE,k="shutdown!",b("FantailLogger").error(b("ChannelConstants").FANTAIL_SERVICE,"entering shutdown state"));this._lastState=f;this._lastStatus=e;this.enterState(k)},_processTransportData:function(a,b){this._processTransportData0(a,b,b.json)},_processTransportData0:function(a,c,d){__p&&__p();var e=d.t;"s"in d&&(d.seq=d.s,delete d.s);if(d.u&&o.user&&d.u!=o.user){j.warn("misguided_msg",JSON.stringify({user:o.user,target:d.u}));this._reportProxyMisguidedMsg(d.u,o.user);return}b("ChannelTransportDataLogger").log(d);var f=o.seq;"seq"in d&&(o.seq=d.seq,b("PresenceState").doSync());switch(e){case"continue":o.inStreaming&&this.heartbeats.length<1&&(o.streamingCapable=!1,j.log("switch_to_longpoll","{}"),b("setTimeoutAcrossTransitions")(this._probeTest,o.PROBE_DELAY));v(!0);(!o.inStreaming||o.STREAMING_EXIT_STATE_ON_CONTINUE)&&this.exitState({status:b("ChannelConstants").OK,stateId:a});break;case"refresh":case"refreshDelay":b("FantailLogger").info(b("ChannelConstants").FANTAIL_SERVICE,"got refresh with reason: %s",d.reason);this.exitState({status:"refresh_"+(d.reason||0),stateId:a},c);break;case"backoff":b("FantailLogger").warn(b("ChannelConstants").FANTAIL_SERVICE,"server told client to back off");v();this.backoff=!0;break;case"lb":var g=d.lb_info;if(g){o.sticky_token=g.sticky;"pool"in g&&(o.sticky_pool=g.pool);if("sd"in g){var h=g.subdomain;b("ChannelTransport").isSubdomain(h)&&(o.subdomain=g.subdomain)}"vip"in g&&(o.host=g.vip);w("chatproxy",JSON.stringify(d))}else j.error("missing_lb_info","{}");break;case"test_streaming":b("setTimeoutAcrossTransitions")(this._probeTest,500);break;case"fullReload":b("PresenceCookieManager").clear();j.log("full_reload","{}");this.sessionRegistered=!0;this.informCurrentSession();b("Arbiter").inform(b("ChannelConstants").ON_INVALID_HISTORY);v(!0);b("FantailLogger").info(b("ChannelConstants").FANTAIL_SERVICE,"full reload incurred");h=b("ChannelConstants").OK;this.exitState({status:h,stateId:a},c);"ms"in d&&this._processMessages(d,f);break;case"msg":v(!0);this._processMessages(d,f);break;case"heartbeat":if(o.inStreaming){g=Date.now();var i;this.heartbeats.length>0&&(i=g-this.heartbeats[this.heartbeats.length-1]);j.log("heartbeat_interval",JSON.stringify({client_id:o.sessionID,interval:i}));this.heartbeats.push(g)}break;case"batched":h=d.batches;for(var f=0;f<h.length;f++)this._processTransportData0(a,c,h[f]);break;default:b("FantailLogger").error(b("ChannelConstants").FANTAIL_SERVICE,"got an unknown protocol message: %s",e);j.error("unknown_msg_type",JSON.stringify({type:e}));break}},_processMessages:function(a,c){__p&&__p();"tr"in a&&(o.trace_id=a.tr);a=a.ms;var d=o.seq-a.length;for(var e=0;e<a.length;e++,d++){o.estimatedReceived++;if(d>=c){var f=a[e];if(f.type){var g=b("ChannelConstants").getArbiterType(f.type);if(f.type==="messaging"){var h={type:"messaging",event:f.event};f.message&&(h.inbox_unread=f.unread_counts&&f.unread_counts.inbox,h.tid=f.message.tid,h.mid=f.message.mid,b("FantailLogger").info(b("ChannelConstants").FANTAIL_SERVICE,"got message with id: %s",f.message.mid))}else f.type==="skywalker"?g=b("ChannelConstants").SKYWALKER:f.type==="qprimer"?(f.first=!o.ready,f.first&&(o.ready=!0,o.timeUntilReady=Date.now()-o.created,o.queueMade=f.made),g=b("ChannelConstants").CHANNEL_ESTABLISHED):f.type==="pws"?o.pws=f.pws:f.type==="delta"&&(o.sequenceId=f.iseq);try{b("Arbiter").inform(g,{obj:f})}catch(a){b("BanzaiODS").bumpEntityKey("ChannelManager","processMessages.error."+f.type),b("FantailLogger").info(b("ChannelConstants").FANTAIL_SERVICE,"message threw exception: %s %s",a,f)}}}else j.warn("seq_regression",JSON.stringify({last_seq:c,messages:a.length,seq:d}))}},_enter_init:function(){if(q.init>=h.getConfig("MAX_INIT_FAILS",2))return b("setTimeoutAcrossTransitions")(function(){return this.exitState({status:b("ChannelConstants").ERROR_MAX,stateId:p})}.bind(this),0);this._initTimer=b("setTimeoutAcrossTransitions")(function(){return this.exitState({status:b("ChannelConstants").ERROR,stateId:p},"timeout")}.bind(this),o.IFRAME_LOAD_TIMEOUT)},_enter_reconnect:function(a){__p&&__p();j.warn("enter_reconnect",a);b("FantailLogger").info(b("ChannelConstants").FANTAIL_SERVICE,"entered reconnect with reason: %s",a);var c=p;if(!b("PresenceUtil").hasUserCookie()){b("FantailLogger").warn(b("ChannelConstants").FANTAIL_SERVICE,"user has no cookie???");j.warn("no_user_cookie","{}");b("setTimeoutAcrossTransitions")(function(){this._shutdownHint=b("ChannelConstants").HINT_AUTH,this.exitState({status:b("ChannelConstants").ERROR_SHUTDOWN,stateId:c})}.bind(this),0);return}a={reason:a,fb_dtsg:b("DTSG").getToken()};b("ISB").token&&(a.fb_isb=b("ISB").token);k&&k(a);var d=new(b("FBAjaxRequest"))("GET","/ajax/presence/reconnect.php",a);d.onSuccess=function(){h.configure(d.json),b("PresenceCookieManager").store(),this.exitState({status:b("ChannelConstants").OK,stateId:c})}.bind(this);d.onError=function(){var a=d.json&&d.json.error;b("FantailLogger").error(b("ChannelConstants").FANTAIL_SERVICE,"reconnect error: %s",d.errorType);(d.errorType==b("AjaxError").TRANSPORT_ERROR||d.errorType==b("AjaxError").PROXY_ERROR||d.errorType==b("AjaxError").SERVICE_UNAVAILABLE)&&(this._shutdownHint=b("ChannelConstants").HINT_CONN);a&&a==1356007?this._shutdownHint=b("ChannelConstants").HINT_MAINT:a==1357001||a==1357004||a==1348009?this._shutdownHint=b("ChannelConstants").HINT_AUTH:this._shutdownHint=null;this.exitState({status:this._shutdownHint?b("ChannelConstants").ERROR_SHUTDOWN:b("ChannelConstants").ERROR,stateId:c},d)}.bind(this);d.send()},_enter_shutdown:function(){b("Arbiter").inform(b("ChannelConstants").ON_SHUTDOWN,{reason:this._shutdownHint});if("shutdown_recovery_interval_seconds"in o&&o.shutdown_recovery_interval_seconds>0){var a=o.shutdown_recovery_interval_seconds*1e3;b("setTimeoutAcrossTransitions")(function(){b("Arbiter").inform(b("ChannelConstants").ATTEMPT_RECONNECT),this._shutdownHint=null,this.state="reconnect!",this.enterState("reconnect!")}.bind(this),a)}},_exit_init:function(a){this._initTimer&&(this._initTimer=b("clearTimeout")(this._initTimer)),a==b("ChannelConstants").ERROR_MAX&&this._sendIframeError(b("ChannelConstants").reason_IFrameLoadGiveUp)},_exit_pull:function(a,c){if(a===b("ChannelConstants").OK){this.lastPullTime=Date.now();return}a="exit status: "+a;c&&c.errorType&&(a+=" ajax request error: "+c.errorType);b("FantailLogger").error(b("ChannelConstants").FANTAIL_SERVICE,"pull failed with status: %s",a)},_exit_ping:function(a){if(a!==b("ChannelConstants").OK){b("FantailLogger").error(b("ChannelConstants").FANTAIL_SERVICE,"ping failed with status: %s",a);return}a=Date.now()-(this.lastPullTime||b("Env").start);if(a>o.STALL_THRESHOLD){b("FantailLogger").error(b("ChannelConstants").FANTAIL_SERVICE,"didnt complete a successful pull for too long");return b("ChannelConstants").ERROR_STALE}},_reportProxyMisguidedMsg:function(a,c){__p&&__p();b("FantailLogger").error(b("ChannelConstants").FANTAIL_SERVICE,"misguided message to %s meant for %s",c,a);var d=Date.now();if(d-this.lastReportOnMisguidedMsgTime<=o.CHANNEL_PROXY_REPORTING_MIN_INTERVAL)return;this.lastReportOnMisguidedMsgTime=d;d={received_uid:a,expected_uid:c};o.sticky_token&&(d.sticky_token=o.sticky_token);a=new(b("URI"))("/err_misguided_msg").setDomain(o.host+"."+o.domain).setPort(o.port).setSecure(new(b("URI"))(window.location.href).isSecure()).setQueryData(d);c=new(b("AjaxRequest"))("GET",a);b("AjaxRequest").supportsCORS()&&(c.xhr.withCredentials=!0);c.onSuccess=function(a){};c.onError=function(a){};c.onJSON=function(a,b){};c.send()},_probeTest:function(){__p&&__p();o.streamingCapable=!1;var a=[],c={mode:"stream",format:"json"};o.sticky_token&&(c.sticky_token=o.sticky_token);c=new(b("URI"))("/probe").setDomain(o.fullHost+"."+o.domain).setPort(o.port).setSecure(new(b("URI"))(window.location.href).isSecure()).setQueryData(c);b("BanzaiODS").bumpEntityKey("ChannelManager","probe.attempt");c=new(b("AjaxRequest"))("GET",c);c.onJSON=function(c,d){if(c&&c.json&&c.json.t==="heartbeat"){a.push(Date.now());if(a.length>=2){d=a[1]-a[0];d>=o.PROBE_HEARTBEATS_INTERVAL_LOW&&d<=o.PROBE_HEARTBEATS_INTERVAL_HIGH?(o.streamingCapable=!0,b("BanzaiODS").bumpEntityKey("ChannelManager","probe.switch_to_streaming"),j.log("switch_to_streaming","{}")):b("BanzaiODS").bumpEntityKey("ChannelManager","probe.failure.delayed")}}};c.onSuccess=function(c){a.length!=2&&(o.streamingCapable=!1,b("BanzaiODS").bumpEntityKey("ChannelManager","probe.failure.data_loss"),j.error("probe_error",JSON.stringify({error:"beats.length = "+a.length}))),b("BanzaiODS").bumpEntityKey("ChannelManager","probe.success"),j.log("probe_success","{}")};c.onError=function(a){o.streamingCapable=!1,b("BanzaiODS").bumpEntityKey("ChannelManager","probe.failure.error"),j.error("probe_error",JSON.stringify(a))};c.send()},_sseProbeTest:function(){__p&&__p();if(!window.EventSource){b("BanzaiODS").bumpEntityKey("ChannelManager","sse_probe.failure.no_event_source");j.log("sse_probe.failure.no_event_source","{}");return}var a=[],c={mode:"sse",format:"json"};o.sticky_token&&(c.sticky_token=o.sticky_token);c=new(b("URI"))("/sse_probe").setDomain(o.fullHost+"."+o.domain).setPort(o.port).setSecure(new(b("URI"))(window.location.href).isSecure()).setQueryData(c);b("BanzaiODS").bumpEntityKey("ChannelManager","sse_probe.attempt");var d=new EventSource(c),e=b("setTimeoutAcrossTransitions")(function(){d.close(),b("BanzaiODS").bumpEntityKey("ChannelManager","sse_probe.failure.timeout"),j.log("sse_probe.failure.timeout","{}")},o.PROBE_HEARTBEATS_INTERVAL_HIGH*6);d.addEventListener("heartbeat",function(c){a.push(Date.now());if(a.length>=2){c=a[1]-a[0];c>=o.PROBE_HEARTBEATS_INTERVAL_LOW&&c<=o.PROBE_HEARTBEATS_INTERVAL_HIGH?(b("BanzaiODS").bumpEntityKey("ChannelManager","sse_probe.success"),j.log("sse_probe.success","{}")):(b("BanzaiODS").bumpEntityKey("ChannelManager","sse_probe.failure.delayed"),j.log("sse_probe.failure.delayed","{}"));b("clearTimeout")(e);d.close()}});d.onerror=function(a){b("BanzaiODS").bumpEntityKey("ChannelManager","sse_probe.failure.error"),j.error("sse_probe.failure.error",JSON.stringify(a)),b("clearTimeout")(e),d.close()}},startChannelManagerForApp:function(a){h.startChannelManager!==b("emptyFunction")&&h.startChannelManager(),b("ChannelInitialData").channelConfig&&o&&(o.profile=a)},startChannelManager:function(){b("ChannelInitialData").channelConfig?(h.configure(b("ChannelInitialData").channelConfig),/shutdown/.test(b("ChannelInitialData").state)&&(h._shutdownHint=b("ChannelConstants")[b("ChannelInitialData").reason]),h.init(b("ChannelInitialData").state,b("ChannelInitialData").reason),b("ChatReliabilityInstrumentation").logCHANNEL_INIT(),this.startChannelManager=b("emptyFunction")):b("ChatReliabilityInstrumentation").logCHANNEL_NOCONFIG()}};e.exports=h}),null);
__d("UFIVideoPlayerRegistry",["EventEmitter","VideoPlayerReason","ViewportBounds","destroyOnUnload","getOrCreateDOMID"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g=new(b("EventEmitter"))(),h=new Map(),i=new Map(),j=new Map(),k=new Map(),l=new Set(),m=new Map();b("destroyOnUnload")(function(){g.removeAllListeners(),h.clear(),i.clear(),j.clear(),k.clear(),l.clear()});function n(a){a=a;var b=[];while(a)b.unshift(a),a=a.parentElement;return b}function o(a,b){__p&&__p();var c=n(a);a=null;var d=null;b.forEach(function(b){var e=b[0];b=b[1];e=n(e);for(var f=0;f<c.length;++f)if(c[f]!==e[f]){(d===null||f>d)&&(d=f,a=b);break}});return a}function p(a,b){__p&&__p();var c=n(a);a=null;var d=null;b.forEach(function(b){var e=b[0];b=b[1];e=n(e);for(var f=0;f<c.length;++f)if(c[f]!==e[f]){(d===null||f>d)&&(d=f,a=b);break}});return a}var q={registerVideoPlayerController:function(a){var b=a.getVideoID(),c=k.get(b);c?c.push(a):(c=[a],k.set(b,c),j["delete"](b));l.forEach(function(a){return a()});a=h.get(b);if(!a)return;a.forEach(function(a){return this._associateUFIController(a,b)}.bind(this))},addOnRegisterListener:function(a){l.add(a)},removeOnRegisterListener:function(a){l["delete"](a)},getAvailableVideoPlayerController:function(a){return i.get(a)},seekAvailableVideoPlayerController:function(a,c){a=q.getAvailableVideoPlayerController(a);if(!a)return;["ready","playing","paused","finished"].includes(a.getState())&&(a.pause(b("VideoPlayerReason").SEEK),a.seek(c),a.play(b("VideoPlayerReason").SEEK))},scrollToAvailableVideo:function(a){a=q.getAvailableVideoPlayerController(a);if(!a)return;a=b("ViewportBounds").getElementPosition(a.getRootNode());window.scroll(0,a.y)},setAvailableVideoPlayerControllerSphericalViewport:function(a,b){a=q.getAvailableVideoPlayerController(a);if(!a)return;a.emit("SphericalVideoViewportTagComment/click",b)},getAvailableVideoPlayerControllerForElement:function(a,c){if(!a)return null;var d=j.get(c)||new Map(),e=b("getOrCreateDOMID")(a);a=d.get(e)||this._findVideoPlayerControllerForElement(a,c);d.set(e,a);j.set(c,d);return a},getAvailableVideoPlayerControllerTimeForElement:function(a,b){if(!a)return null;a=q.getAvailableVideoPlayerControllerForElement(a,b);if(!a)return null;b=a.getCurrentTimePosition();return b>=0?Math.floor(b):null},getAvailableVideoPlayerControllerTime:function(a){a=q.getAvailableVideoPlayerController(a);if(!a)return null;a=a.getCurrentTimePosition();return a>=0?Math.floor(a):null},registerUFIController:function(a,b,c){var d=a.getInstanceID(),e=a.getFluentContentToken();if(!e)return;var f=h.get(e);f?f.push(a):(f=[a],h.set(e,f));g.addListener(d+"/register",b);g.addListener(d+"/unregister",c);this._associateUFIController(a,e)},getAvailableUFIController:function(a){__p&&__p();var b=m.get(a);if(b)return b;var c=h.get(a.getVideoID());if(!c)return null;c.length===1?b=c[0]:b=p(a.getRootNode(),c.map(function(a){return[a.getRootNode(),a]}));if(b){c=this._findVideoPlayerControllerForElement(b.getRootNode(),a.getVideoID());if(c!==a)return null;m.set(a,b)}return b},findVideoPlayerControllerByVideoID:function(a){return this._findVideoPlayerControllerForElement(null,a)},_findVideoPlayerControllerForElement:function(a,b){b=k.get(b);if(!b)return null;if(b.length===1)return b[0];return!a?null:o(a,b.filter(function(a){return!a.isState("destroyed")}).map(function(a){return[a.getRootNode(),a]}))},_associateUFIController:function(a,c){__p&&__p();var d=a.getInstanceID();a=this._findVideoPlayerControllerForElement(a.getRootNode(),c);if(!a||a.isState("destroyed"))return;c=i.get(d);if(c){if(!c.isState("destroyed")&&b("getOrCreateDOMID")(c.getRootNode())===b("getOrCreateDOMID")(a.getRootNode()))return;g.emit(d+"/unregister")}i.set(d,a);g.emit(d+"/register",a)}};e.exports=q}),null);
__d("FBCircularGlyph.react",["cx","Image.react","React","joinClasses"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h;c=b("React").PropTypes;h=babelHelpers.inherits(a,b("React").Component);h&&h.prototype;a.prototype.render=function(){var a=this.props,c=a.circleSize,d=a.glyph,e=a.glyphSize;a=babelHelpers.objectWithoutProperties(a,["circleSize","glyph","glyphSize"]);return b("React").createElement("div",babelHelpers["extends"]({},a,{className:b("joinClasses")("_32qy",a.className),style:babelHelpers["extends"]({width:c,height:c},a.style)}),b("React").createElement("div",{className:"_32qz"},b("React").createElement("div",{className:"_32q-"},b("React").createElement(b("Image.react"),{src:d,width:e,height:e}))))};function a(){h.apply(this,arguments)}a.propTypes={circleSize:c.number,glyph:c.oneOfType([c.object,c.string])};e.exports=a}),null);
__d("LitestandStoryInsertionStatus",["ArbiterMixin"],(function(a,b,c,d,e,f){var g="check";a={registerBlocker:function(a){return this.subscribe(g,function(b,c){c.can_insert&&a()&&(c.can_insert=!1)})},canInsert:function(){var a={can_insert:!0};this.inform(g,a);return a.can_insert}};Object.assign(a,b("ArbiterMixin"));e.exports=a}),null);
__d("RealtimeEntityPresenceTypedLogger",["Banzai","GeneratedLoggerUtils","nullthrows"],(function(a,b,c,d,e,f){"use strict";__p&&__p();function a(){this.clear()}a.prototype.log=function(){b("GeneratedLoggerUtils").log("logger:RealtimeEntityPresenceLoggerConfig",this.$1,b("Banzai").BASIC)};a.prototype.logVital=function(){b("GeneratedLoggerUtils").log("logger:RealtimeEntityPresenceLoggerConfig",this.$1,b("Banzai").VITAL)};a.prototype.logImmediately=function(){b("GeneratedLoggerUtils").log("logger:RealtimeEntityPresenceLoggerConfig",this.$1,{signal:!0})};a.prototype.clear=function(){this.$1={};return this};a.prototype.getData=function(){return babelHelpers["extends"]({},this.$1)};a.prototype.updateData=function(a){this.$1=babelHelpers["extends"]({},this.$1,a);return this};a.prototype.setAction=function(a){this.$1.action=a;return this};a.prototype.setActionReason=function(a){this.$1.action_reason=a;return this};a.prototype.setAppID=function(a){this.$1.app_id=a;return this};a.prototype.setCapabilities=function(a){this.$1.capabilities=a;return this};a.prototype.setClientSubscriptionID=function(a){this.$1.client_subscription_id=a;return this};a.prototype.setClientTimeMs=function(a){this.$1.client_time_ms=a;return this};a.prototype.setEntityHandler=function(a){this.$1.entity_handler=a;return this};a.prototype.setEntityID=function(a){this.$1.entity_id=a;return this};a.prototype.setEntityType=function(a){this.$1.entity_type=a;return this};a.prototype.setEventSource=function(a){this.$1.event_source=a;return this};a.prototype.setExceptionMessage=function(a){this.$1.exception_message=a;return this};a.prototype.setExceptionType=function(a){this.$1.exception_type=a;return this};a.prototype.setGatewayConnected=function(a){this.$1.gateway_connected=a;return this};a.prototype.setSequenceID=function(a){this.$1.sequence_id=a;return this};a.prototype.setSessionID=function(a){this.$1.session_id=a;return this};a.prototype.setSourceHost=function(a){this.$1.source_host=a;return this};a.prototype.setSourceTwTaskHandle=function(a){this.$1.source_tw_task_handle=a;return this};a.prototype.setTopic=function(a){this.$1.topic=a;return this};a.prototype.setUserAgentString=function(a){this.$1.user_agent_string=a;return this};a.prototype.setUserFbid=function(a){this.$1.user_fbid=a;return this};c={action:!0,action_reason:!0,app_id:!0,capabilities:!0,client_subscription_id:!0,client_time_ms:!0,entity_handler:!0,entity_id:!0,entity_type:!0,event_source:!0,exception_message:!0,exception_type:!0,gateway_connected:!0,sequence_id:!0,session_id:!0,source_host:!0,source_tw_task_handle:!0,topic:!0,user_agent_string:!0,user_fbid:!0};e.exports=a}),null);
__d("EntityPresenceLogger",["CurrentUser","EntityPresenceConfig","Int64","Random","RealtimeEntityPresenceTypedLogger","UserAgentData","gkx"],(function(a,b,c,d,e,f){"use strict";__p&&__p();function a(a,b,c){this.entityType=a,this.entityID=b,this.subscriptionID=c,this.shouldLog=this.$1(),this.sequenceID=0}a.prototype.logEnter=function(a){this.shouldLog&&this.$2().setAction("enter").setSequenceID(++this.sequenceID).setCapabilities(a).log()};a.prototype.logSubscribeCallback=function(a){this.shouldLog&&this.$2().setAction("subscribe_completed").setActionReason(a?"succeeded":"failed").log()};a.prototype.logPing=function(){this.shouldLog&&this.$2().setAction("ping").setSequenceID(++this.sequenceID).log()};a.prototype.logSkippedPing=function(){this.shouldLog&&this.$2().setAction("skipped_ping").setSequenceID(this.sequenceID).log()};a.prototype.logChangeCapabilities=function(a){this.shouldLog&&this.$2().setAction("change_capabilities").setSequenceID(++this.sequenceID).setCapabilities(a).log()};a.prototype.logLeave=function(){this.shouldLog&&this.$2().setAction("leave").setSequenceID(++this.sequenceID).log()};a.prototype.logUnsubscribeCallback=function(a){this.shouldLog&&this.$2().setAction("unsubscribe_completed").setActionReason(a?"succeeded":"failed").log()};a.prototype.getLogInfo=function(){return this.shouldLog?{client_subscription_id:this.subscriptionID,sequence_id:this.sequenceID.toString()}:{}};a.prototype.$1=function(){if(b("gkx")("AT6nv-r2e-6DjmPwOoWQnM9N5VZy9BeOri3IOKEQWzhE089oyZfXdXDuYHfFxZxCqDwTERVlCWg_l3_mURz3CechiPOAqWKRwA0eYVFKP7Hnog"))return!0;return b("gkx")("AT4Sccn1-o-QcqNGgL8r4GwRxYs_QDTgxMFZeHzMwJY5BjClloZdpSkQv9wFkK65r-J2NfeY877CkcxM9CgqnyPhTrIvwZWhV3GkKmPIemHeWA")?b("Random").random()<b("EntityPresenceConfig").sessionLoggingSamplingRate:!1};a.prototype.$2=function(){return new(b("RealtimeEntityPresenceTypedLogger"))().setEntityType(this.entityType).setEntityID(this.entityID).setClientSubscriptionID(this.subscriptionID).setClientTimeMs(Date.now()).setEventSource("client").setAppID("229895473858072").setUserFbid(b("CurrentUser").getID()).setUserAgentString(b("UserAgentData").browserName+"/"+(b("UserAgentData").browserFullVersion||""))};e.exports=a}),null);
__d("EntityPresenceManager",["Arbiter","ChannelConstants","EntityPresenceConfig","EntityPresenceLogger","FBLogger","Int64","RTISubscriptionManager","UserActivity","uuid"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g="entity_presence",h="capabilities",i={users:0,activePing:null,start:function(){this.users++,b("EntityPresenceConfig").activePingEnabled&&(b("RTISubscriptionManager").activePing(),this.activePing===null&&(this.activePing=setInterval(function(){b("UserActivity").isOnTab()?(b("RTISubscriptionManager").activePing(),b("Arbiter").inform(b("ChannelConstants").ENTITY_PRESENCE_ACTIVE_PING)):b("Arbiter").inform(b("ChannelConstants").ENTITY_PRESENCE_SKIPPED_PING)},b("EntityPresenceConfig").activePingFrequency)))},stop:function(){this.users--,this.users==0&&this.activePing!==null&&(clearInterval(this.activePing),this.activePing=null)}};a={enter:function(a,c,d){__p&&__p();var e=g+"/"+a+"/"+c,f=b("uuid")(),j=new(b("EntityPresenceLogger"))(a,c,f);j.logEnter(d);a=j.getLogInfo();d&&(a[h]=d.toString());var k=b("RTISubscriptionManager").subscribe(e,function(){b("FBLogger")(g).warn("Unexpected update received for entity presence")},a,function(a){a=a!=null&&a.data!=null;j.logSubscribeCallback(a)},null,function(a){a=a!=null&&a.data!=null;j.logUnsubscribeCallback(a)});i.start();return{called:!1,capabilities:d,pingListener:null,skippedPingListener:null,changeCapabilities:function(a){j.logChangeCapabilities(a);var b=j.getLogInfo();a&&(b[h]=a.toString());k.mutateContext(b);this.capabilities=a},leave:function(){__p&&__p();if(this.called){b("FBLogger")(g).warn("leave() called twice for same PresenceTokenType");return}j.logLeave();i.stop();b("Arbiter").unsubscribe(this.pingListener);b("Arbiter").unsubscribe(this.skippedPingListener);k.fastUnsubscribe();this.called=!0},_init:function(){this.pingListener=b("Arbiter").subscribe(b("ChannelConstants").ENTITY_PRESENCE_ACTIVE_PING,function(a){j.logPing()});this.skippedPingListener=b("Arbiter").subscribe(b("ChannelConstants").ENTITY_PRESENCE_SKIPPED_PING,function(a){j.logSkippedPing()});return this}}._init()}};e.exports=a}),null);
__d("DocumentFocusForAdsVideoAutoplayRule",["VideoAutoplayRule"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g;c=babelHelpers.inherits(a,b("VideoAutoplayRule"));g=c&&c.prototype;function a(a){g.constructor.call(this,a)}a.prototype.calculateAutoplayScore=function(){return this.isEnabled()?this.$DocumentFocusForAdsVideoAutoplayRule1():1};a.prototype.$DocumentFocusForAdsVideoAutoplayRule1=function(){var a=this.videoUnit.getVideoPlayerController();return a&&a.isAd()?document.hasFocus()?1:0:1};e.exports=a}),null);
__d("FeedVideoClickToPlayController",["DocumentFocusForAdsVideoAutoplayRule","Event","IntersectionObserver","VideoPlayerAbortLoadingExperiment","VideoPlayerExperiments","VideoPlayerReason","destroyOnUnload","gkx","setImmediate","throttle"],(function(a,b,c,d,e,f){__p&&__p();var g=null;function h(){"use strict";this.$4=new Set(),b("gkx")("AT6eo_aGxp7kGc9uQcRUv5qgXR78t6eoDhWoOgoiH66ouJ4V1kK2IFdSqwWApT-hWvFPv4Lj0nBM27rV7xKX1X7a")?this.$3=new(b("IntersectionObserver"))(function(a){this.onWindowEvent()}.bind(this),{threshold:[0,.5,1]}):this.$3=null,this.$2=null,this.$1=null,b("destroyOnUnload")(function(){this.$4.clear(),this.$2&&(this.$2.remove(),this.$2=null),this.$3&&(this.$3.disconnect(),this.$3=null),this.$1&&(this.$1.remove(),this.$1=null),this===g&&(g=null)}.bind(this))}h.prototype.addVideoUnit=function(a){"use strict";__p&&__p();if(b("VideoPlayerExperiments").useBringYourOwnAutoplayRule&&b("VideoPlayerExperiments").pauseAdIfNoDocumentFocus){var c=new(b("DocumentFocusForAdsVideoAutoplayRule"))(a);a.registerAutoplayRule(c)}b("gkx")("AT6eo_aGxp7kGc9uQcRUv5qgXR78t6eoDhWoOgoiH66ouJ4V1kK2IFdSqwWApT-hWvFPv4Lj0nBM27rV7xKX1X7a")?this.$5()||this.$6():this.$7()||this.$8();this.$9()||this.$10();a.addListener("beginPlayback",function(c){c=c.reason;(c===b("VideoPlayerReason").USER||c===b("VideoPlayerReason").LOOP)&&this.$4.add(a)}.bind(this));a.addListener("turnOffAutoplay",function(b){b=b.reason;b==="unmuted"&&this.$4.add(a)}.bind(this));a.getVideoPlayerController().isState("playing")&&!a.isAutoplayable()&&this.$4.add(a);a.addListener("pausePlayback",function(){this.$4["delete"](a)}.bind(this));a.addListener("finishPlayback",function(){this.$4["delete"](a)}.bind(this))};h.registerVideoUnit=function(a){"use strict";g==null&&(g=new h()),g.addVideoUnit(a)};h.prototype.$8=function(){"use strict";this.$2&&this.$2.remove(),this.$2=b("Event").listen(window,"scroll",b("throttle")(this.onWindowEvent.bind(this),200))};h.prototype.$6=function(){"use strict";this.$3&&this.$3.disconnect(),this.$3.observe(window)};h.prototype.$10=function(){"use strict";this.$1&&this.$1.remove(),this.$1=b("Event").listen(window,"resize",b("throttle")(this.onWindowEvent.bind(this),200))};h.prototype.$7=function(){"use strict";return!!this.$2};h.prototype.$5=function(){"use strict";return!!this.$3};h.prototype.$9=function(){"use strict";return!!this.$1};h.prototype.$11=function(a){"use strict";a.pause(b("VideoPlayerReason").AUTOPLAY),!b("VideoPlayerExperiments").noAbortLoadingInFeedClickToPlay&&b("VideoPlayerAbortLoadingExperiment").canAbort&&a.abortLoading(),this.$4["delete"](a)};h.prototype.onWindowEvent=function(){"use strict";this.$4.forEach(function(a){if(a&&!a.isVisible()&&!a.getIsInChannel()){var c=a.getVideoPlayerController();c.isAd()||b("VideoPlayerExperiments").pauseWhenOffscreen?b("VideoPlayerExperiments").slidingWNSv3?b("setImmediate")(function(){a&&!a.isVisible()&&!a.getIsInChannel()&&this.$11(a)}.bind(this)):this.$11(a):c.isMuted()&&c.isState("playing")&&(this.$11(a),c.emit("resumeAutoplay"))}}.bind(this))};e.exports=h}),null);
__d("FeedVideoPlayerController",["csx","Arbiter","AttachmentRelatedShareConstants","DOM","DOMQuery","LitestandStoryInsertionStatus","Run","SubscriptionsHandler","VideoAutoplayPlayerBase","VideoPlayerApiEvents","VideoPlayerExperiments","VideoPlayerFallbackEvents","VideoPlayerLoggerErrors","VideoPlayerLoggerErrorStates","VideoPlayerLoggerEvent","VideoPlayerReason","VideoPlayerStates","getElementPosition","getViewportDimensions"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h,i=42;c=babelHelpers.inherits(a,b("VideoAutoplayPlayerBase"));h=c&&c.prototype;function a(a,c){__p&&__p();h.constructor.call(this);this.$FeedVideoPlayerController1=c;this.$FeedVideoPlayerController2=a;this.$FeedVideoPlayerController3=new Set();this.$FeedVideoPlayerController1.viewport_autoplay||this.$FeedVideoPlayerController3.add("server_blocked");this.$FeedVideoPlayerController12=b("VideoPlayerExperiments").autoplayUntilHalfGone?.5:1;this.$FeedVideoPlayerController4=this.isAutoplayable();this.$FeedVideoPlayerController6=c.controller;this.$FeedVideoPlayerController10=c.startsMuted;this.$FeedVideoPlayerController13=!1;this.$FeedVideoPlayerController7=this.isAutoplayable();(this.$FeedVideoPlayerController6.getIsInChannel()||this.$FeedVideoPlayerController6.isState(b("VideoPlayerStates").PLAYING)&&!this.$FeedVideoPlayerController6.isMuted())&&(this.$FeedVideoPlayerController7=!1);this.$FeedVideoPlayerController6.registerOption("FeedAutoplay","isAutoplaying",function(){return this.$FeedVideoPlayerController7}.bind(this),function(a){this.$FeedVideoPlayerController7=a}.bind(this));this.$FeedVideoPlayerController6.registerOption("FeedAutoplay","isVisibleForAutoplay",function(){return this.isVisible()}.bind(this));this.$FeedVideoPlayerController6.registerOption("FeedAutoplay","shouldOpenSidePaneInChannelView",function(){return c.autoPlayWithChannelViewOrSnowlift});this.$FeedVideoPlayerController6.registerOption("FeedAutoplay","isFilteredByWarningScreen",function(){return this.$FeedVideoPlayerController13}.bind(this),function(a){this.$FeedVideoPlayerController13=a}.bind(this));this.$FeedVideoPlayerController6.setLogEntryPropertyGetters({autoplay_eligible:function(){return this.isAutoplayable()}.bind(this),autoplay_failure_reasons:function(){return JSON.stringify(Array.from(this.$FeedVideoPlayerController3))}.bind(this)});this.$FeedVideoPlayerController14();b("Run").onLeave(function(){this.$FeedVideoPlayerController5.release()}.bind(this));if(this.isState(b("VideoPlayerStates").FALLBACK)){this.$FeedVideoPlayerController15();this.$FeedVideoPlayerController16();return}this.$FeedVideoPlayerController5.addSubscriptions(b("LitestandStoryInsertionStatus").registerBlocker(function(){return this.isState(b("VideoPlayerStates").PLAYING)}.bind(this)))}a.prototype.$FeedVideoPlayerController17=function(){return this.$FeedVideoPlayerController6.isState(b("VideoPlayerStates").DESTROYED)};a.prototype.$FeedVideoPlayerController18=function(){return!!this.$FeedVideoPlayerController1.show_play_button_on_finish};a.prototype.getDistanceToViewport=function(){if(this.$FeedVideoPlayerController17())return-Infinity;if(this.$FeedVideoPlayerController6.isFullscreen())return 0;var a=b("getViewportDimensions")().height,c=this.getDOMPosition();if(c.height===0)return-Infinity;c=c.y+(1-this.$FeedVideoPlayerController12)*c.height;return c-a/2};a.prototype.isVisible=function(){__p&&__p();if(this.$FeedVideoPlayerController17())return!1;if(this.$FeedVideoPlayerController6.isFullscreen())return!0;var a=b("getViewportDimensions")().height,c=b("getViewportDimensions")().width,d=this.getDOMPosition();if(d.height===0)return!1;var e=d.y-i+(1-this.$FeedVideoPlayerController12)*d.height,f=d.y+this.$FeedVideoPlayerController12*d.height,g=d.x+(1-this.$FeedVideoPlayerController12)*d.width,h=d.x+this.$FeedVideoPlayerController12*d.width;if(e<0||f>=a||g<0||h>=c)return!1;e=this.$FeedVideoPlayerController19();return e!==null?this.$FeedVideoPlayerController20(d,b("getElementPosition")(e)):!0};a.prototype.$FeedVideoPlayerController19=function(){var a=b("DOMQuery").scry(this.$FeedVideoPlayerController2.video_container,"^div._1yj5");return a.length>0?a[0]:null};a.prototype.$FeedVideoPlayerController20=function(a,b){var c=a.x;a=a.x+a.width;var d=b.x;b=b.x+b.width;return d<c&&a<b};a.prototype.isAutoplayable=function(){return this.$FeedVideoPlayerController1.viewport_autoplay&&!this.$FeedVideoPlayerController9&&!this.$FeedVideoPlayerController3.size&&!this.$FeedVideoPlayerController13};a.prototype.$FeedVideoPlayerController21=function(a){this.$FeedVideoPlayerController4&&(this.$FeedVideoPlayerController4=!1,this.$FeedVideoPlayerController6.unmute()),this.$FeedVideoPlayerController6.play(a)};a.prototype.getCurrentTimePosition=function(){return this.$FeedVideoPlayerController6.getCurrentTimePosition()};a.prototype.playWithoutUnmute=function(a){this.$FeedVideoPlayerController6.play(a)};a.prototype.getVideoID=function(){return this.$FeedVideoPlayerController6.getVideoID()};a.prototype.$FeedVideoPlayerController22=function(){this.$FeedVideoPlayerController16()};a.prototype.$FeedVideoPlayerController14=function(){__p&&__p();this.$FeedVideoPlayerController5=new(b("SubscriptionsHandler"))();var a=[["finishPlayback",function(){return this.$FeedVideoPlayerController23()}.bind(this)],["turnOffAutoplay",function(a){var b=null;a&&(b=a.reason);this.$FeedVideoPlayerController24(b)}.bind(this)],["unmuteVideo",function(){return this.$FeedVideoPlayerController25()}.bind(this)],["stateChange",function(){return this.$FeedVideoPlayerController26()}.bind(this)],["switchVideo",function(){return this.$FeedVideoPlayerController22()}.bind(this)],["fallbackPlay",function(){return this.$FeedVideoPlayerController27()}.bind(this)],["buffered",function(){return this.$FeedVideoPlayerController16()}.bind(this)],["buffering",function(){return this.$FeedVideoPlayerController16()}.bind(this)],["beginPlayback",function(a){a=a.reason;return this.$FeedVideoPlayerController28(a)}.bind(this)],["toggleFullscreen",function(){return this.$FeedVideoPlayerController29()}.bind(this)],["resumeAutoplay",function(a){var b=null;a&&(b=a.reason);this.$FeedVideoPlayerController30(b)}.bind(this)],["crossfadeWatchAndScroll",function(){return this.$FeedVideoPlayerController31()}.bind(this)],["enterWatchAndScroll",function(){return this.$FeedVideoPlayerController31()}.bind(this)],["exitWatchAndScroll",function(){return this.$FeedVideoPlayerController32()}.bind(this)],["muteVideo",function(){return this.$FeedVideoPlayerController33()}.bind(this)]],c=function(event){return this.emit.bind(this,event)}.bind(this);this.$FeedVideoPlayerController5.addSubscriptions.apply(this.$FeedVideoPlayerController5,a.map(function(a){var b=a[0];a=a[1];return this.$FeedVideoPlayerController6.addListener(b,a)}.bind(this)).concat(b("VideoPlayerApiEvents").map(function(event){return this.$FeedVideoPlayerController6.addListener(event,c(event))}.bind(this))))};a.prototype.$FeedVideoPlayerController33=function(){b("VideoPlayerExperiments").fixFeedVideosPlayOffscreen&&this.$FeedVideoPlayerController34("unmuted")};a.prototype.$FeedVideoPlayerController32=function(){b("VideoPlayerExperiments").fixFeedVideosPlayOffscreen&&(this.$FeedVideoPlayerController34("watch_and_scroll"),this.$FeedVideoPlayerController6&&this.$FeedVideoPlayerController6.isMuted()&&this.$FeedVideoPlayerController34("unmuted"))};a.prototype.$FeedVideoPlayerController31=function(){b("VideoPlayerExperiments").fixFeedVideosPlayOffscreen&&(this.$FeedVideoPlayerController35("watch_and_scroll"),this.$FeedVideoPlayerController34("manually_paused"))};a.prototype.$FeedVideoPlayerController29=function(){this.$FeedVideoPlayerController10&&this.$FeedVideoPlayerController6.unmute()};a.prototype.$FeedVideoPlayerController26=function(){if(this.$FeedVideoPlayerController17())return;this.$FeedVideoPlayerController6.isState(b("VideoPlayerStates").FALLBACK)&&this.$FeedVideoPlayerController15();!this.$FeedVideoPlayerController6.isState(b("VideoPlayerStates").LOADING)&&this.$FeedVideoPlayerController8&&(clearTimeout(this.$FeedVideoPlayerController8),this.$FeedVideoPlayerController8=null);this.$FeedVideoPlayerController16()};a.prototype.$FeedVideoPlayerController28=function(a){b("VideoPlayerExperiments").fixFeedVideosPlayOffscreen&&this.$FeedVideoPlayerController34("manually_paused"),a===b("VideoPlayerReason").USER&&this.$FeedVideoPlayerController10&&this.$FeedVideoPlayerController6.unmute()};a.prototype.preload=function(){this.$FeedVideoPlayerController6.preload&&this.$FeedVideoPlayerController6.preload()};a.prototype.logDisplayed=function(){this.$FeedVideoPlayerController6.logEvent(b("VideoPlayerLoggerEvent").DISPLAYED,{autoplay_reason:this.$FeedVideoPlayerController1.autoplay_reason})};a.prototype.$FeedVideoPlayerController27=function(){var a={error:b("VideoPlayerLoggerErrors").ENTERED_FALLBACK,state:b("VideoPlayerLoggerErrorStates").PLAYBACK_FAILURE};this.$FeedVideoPlayerController6.logEvent(b("VideoPlayerLoggerEvent").ERROR,a)};a.prototype.$FeedVideoPlayerController25=function(){b("VideoPlayerExperiments").slidingWNSv3&&this.$FeedVideoPlayerController6.isAd()&&(this.$FeedVideoPlayerController12=.5),this.$FeedVideoPlayerController10=!1,this.$FeedVideoPlayerController7=!1};a.prototype.$FeedVideoPlayerController23=function(){var a=this.$FeedVideoPlayerController6.getOption("Looping","isLooping");a||this.$FeedVideoPlayerController35("has_seen_finished")};a.prototype.$FeedVideoPlayerController15=function(){this.$FeedVideoPlayerController11={isAutoplaying:this.$FeedVideoPlayerController7,preventAutoplay:this.$FeedVideoPlayerController9},this.$FeedVideoPlayerController35(b("VideoPlayerStates").FALLBACK)};a.prototype.$FeedVideoPlayerController35=function(a){this.$FeedVideoPlayerController9=!0,a&&this.$FeedVideoPlayerController3.add(a),this.$FeedVideoPlayerController7=!1};a.prototype.$FeedVideoPlayerController30=function(a){this.$FeedVideoPlayerController34(a)};a.prototype.$FeedVideoPlayerController34=function(a){a?this.$FeedVideoPlayerController3["delete"](a):(this.$FeedVideoPlayerController3["delete"]("unmuted"),this.$FeedVideoPlayerController3["delete"]("has_seen_finished"),this.$FeedVideoPlayerController3["delete"]("manually_paused")),this.$FeedVideoPlayerController9=this.$FeedVideoPlayerController3.size>0,this.$FeedVideoPlayerController7=!this.$FeedVideoPlayerController9};a.prototype.$FeedVideoPlayerController24=function(a){this.$FeedVideoPlayerController35(a),this.$FeedVideoPlayerController7=!1};a.prototype.$FeedVideoPlayerController16=function(){this.$FeedVideoPlayerController36()};a.prototype.getDOMPosition=function(){return this.$FeedVideoPlayerController6.getDOMPosition()};a.prototype.isLooping=function(){return!!this.$FeedVideoPlayerController6.getOption("Looping","isLooping")};a.prototype.pause=function(a){this.$FeedVideoPlayerController6.pause(a)};a.prototype.$FeedVideoPlayerController37=function(){this.$FeedVideoPlayerController14(),this.$FeedVideoPlayerController3["delete"](b("VideoPlayerStates").FALLBACK),this.$FeedVideoPlayerController7=this.$FeedVideoPlayerController11.isAutoplaying,this.$FeedVideoPlayerController9=this.$FeedVideoPlayerController11.preventAutoplay};a.prototype.$FeedVideoPlayerController36=function(){if(this.isState(b("VideoPlayerStates").FALLBACK)){this.$FeedVideoPlayerController5.release();var a=this.$FeedVideoPlayerController2;a.fallback_link&&(b("DOM").remove(this.$FeedVideoPlayerController6.getVideoNode()),b("DOM").replace(a.video_container,a.fallback_link),b("DOM").appendContent(a.fallback_link,a.video_container));if(this.$FeedVideoPlayerController6.isFallbackRecoverable())this.$FeedVideoPlayerController37();else var c=this.$FeedVideoPlayerController6.addListener(b("VideoPlayerFallbackEvents").RECOVER,function(){this.$FeedVideoPlayerController37(),c.remove()}.bind(this))}};a.prototype.$FeedVideoPlayerController38=function(){b("Arbiter").inform(b("AttachmentRelatedShareConstants").FBVIDEO_CLICK,{attachment:this.$FeedVideoPlayerController2.video_container,fbvideo_id:this.$FeedVideoPlayerController1.video_ids[0]})};a.prototype.isState=function(a){return this.$FeedVideoPlayerController6.isState(a)};a.prototype.getSource=function(){return this.$FeedVideoPlayerController6.getSource()};a.prototype.getIsInChannel=function(){return this.$FeedVideoPlayerController6.getIsInChannel()};a.prototype.getVideoPlayerController=function(){return this.$FeedVideoPlayerController6};a.prototype.abortLoading=function(){this.$FeedVideoPlayerController1.abort_loading_blocked||this.$FeedVideoPlayerController6.abortLoading()};a.prototype.isMuted=function(){return this.$FeedVideoPlayerController6.isMuted()};a.prototype.isPlaying=function(){return this.$FeedVideoPlayerController6.isState("playing")};a.prototype.shouldPauseWhenScrolledOffscreen=function(){return!1};e.exports=a}),null);
__d("VideoFeedRegister",["Bootloader","FeedVideoPlayerController","VideoAutoplayControllerX","VideoPlayerExperiments","VideoPlayerFeedRegisterConfig","gkx"],(function(a,b,c,d,e,f){__p&&__p();a={registerVideoUnit:function(a,c){__p&&__p();var d=c.controller;c.controller.getOption("VideoWithInstreamVideo","enabled")&&(c.controller=c.controller.getOption("VideoWithInstreamVideo","controller"));var e=new(b("FeedVideoPlayerController"))(a,c);c.controller.registerOption("WatchAndScroll","isEligible",function(){return c.wnsEnabled});if(c.channelVersion){if((c.channelVersion!=="channel_view"||!c.channelModule.getInteraction())&&b("VideoPlayerFeedRegisterConfig").watchAndScrollModule&&b("VideoPlayerFeedRegisterConfig").watchAndScrollModule.isActive()){b("VideoPlayerFeedRegisterConfig").watchAndScrollModule.registerChannelVideoController(c.controller);return}c.channelVersion==="channel_view"&&c.channelModule.registerVideoController(c.controller)}else if(b("gkx")("AT4JzxHQIxRND8Kmb4P0ZKgRZIAtL9c6D4Sb7E0b1oCDX0oYcMUrO_8NRrEgEKcOrnd9zWa26WQWQYrttYx8SZzBTB7PEFVsuhlrNpYaHcKJ5Q")){a=e.getVideoPlayerController();a&&a.runOnApiReady(function(){b("VideoAutoplayControllerX").registerVideoUnit(e)})}else b("VideoAutoplayControllerX").registerVideoUnit(e);c.wnsEnabled&&b("VideoPlayerFeedRegisterConfig").watchAndScrollModule&&b("VideoPlayerFeedRegisterConfig").watchAndScrollModule.registerVideoController(c.controller,c.videoChannelCaller,b("VideoPlayerFeedRegisterConfig").watchAndScrollV3,b("VideoPlayerFeedRegisterConfig").wnsChannelsIntegrationEnabled);!b("VideoPlayerExperiments").disableDisableOffscreenPlayModule&&b("VideoPlayerFeedRegisterConfig").disableOffscreenPlayModule&&b("VideoPlayerFeedRegisterConfig").disableOffscreenPlayModule.registerVideoUnit(e);if(c.autoPlayWithChannelViewOrSnowlift){var f=d;f.runOnApiReady(function(){b("Bootloader").loadModules(["PhotoSnowlift"],function(a){return a.bootstrap(f.getVideoURL())},"VideoFeedRegister")})}}};e.exports=a}),null);
__d("VideoPlayerRegistry",["regeneratorRuntime","Promise","EventEmitter"],(function(a,b,c,d,e,f){__p&&__p();var g=new Set(),h=new(b("EventEmitter"))(),i={ADDED:"added",REMOVED:"removed",addListener:function(a,b){return h.addListener(a,b)},once:function(a,b){return h.once(a,b)},has:function(a){return g.has(a)},add:function(a){if(i.has(a))return!1;g.add(a);h.emit(i.ADDED,a);return!0},remove:function(a){if(!i.has(a))return!1;g["delete"](a);h.emit(i.REMOVED,a);return!0},count:function(){return g.size},getList:function(){return Array.from(g)},getByRootNode:function(a){__p&&__p();var c;return b("regeneratorRuntime").async(function(d){__p&&__p();while(1)switch(d.prev=d.next){case 0:c=null;this.getList().forEach(function(b){b.getByRootNode()===a&&(c=b)});if(c){d.next=6;break}d.next=5;return b("regeneratorRuntime").awrap(new(b("Promise"))(function(b,c){var d=this.addListener(i.ADDED,function(c){c.getRootNode()===a&&(d.remove(),b(c))})}.bind(this)));case 5:c=d.sent;case 6:return d.abrupt("return",c);case 7:case"end":return d.stop()}},null,this)}};e.exports=i}),null);
__d("VideoScrubberPreviewComponent",[],(function(a,b,c,d,e,f){__p&&__p();function g(a,b){"use strict";__p&&__p();if(!b)throw new Error("VideoScrubberPreview Component config null.");this.$4=b;this.$5=a;this.$2=b.hasPreviewThumbnails;this.$3=g.getSpriteURIs(b.spriteIndexToURIMap);this.$5.isPlayingVODHighlights()||this.$6();this.$5.addListener("switchedToFullVideo",function(){return this.$6()}.bind(this));this.$5.addListener("switchedToLiveVODHighlights",function(){return this.$7()}.bind(this))}g.prototype.hasPreviewThumbnails=function(){"use strict";return this.$2};g.prototype.$6=function(){"use strict";this.$5.registerOption("VideoScrubberPreviewComponent","scrubberPreviewSprites",this.getSprites.bind(this)),this.$5.registerOption("VideoScrubberPreviewComponent","hasPreviewThumbnails",this.hasPreviewThumbnails.bind(this)),this.$5.registerOption("VideoScrubberPreviewComponent","previewThumbnailInformation",this.getPreviewThumbnailInformation.bind(this))};g.prototype.$7=function(){"use strict";this.$5.unregisterOption("VideoScrubberPreviewComponent","scrubberPreviewSprites"),this.$5.unregisterOption("VideoScrubberPreviewComponent","hasPreviewThumbnails"),this.$5.unregisterOption("VideoScrubberPreviewComponent","previewThumbnailInformation")};g.prototype.getSprites=function(){"use strict";return this.$3};g.prototype.getPreviewThumbnailInformation=function(){"use strict";this.hasPreviewThumbnails()?this.$4.imagesPerColumn=this.$4.maxImagesPerSprite/this.$4.imagesPerRow:this.$4.imagesPerColumn=0;return this.$4};g.getSpriteURIs=function(a){"use strict";var b=new Map();for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&b.set(parseInt(c,10),a[c]);return b};e.exports=g}),null);
__d("VODPresenceCVCDisplayStage",[],(function(a,b,c,d,e,f){e.exports=Object.freeze({PRE_ENTER:"pre_enter",POST_ENTER:"post_enter"})}),null);
__d("VideoVODCVCFetchingQueryWebGraphQLQuery",["WebGraphQLQueryBase"],(function(a,b,c,d,e,f){"use strict";__p&&__p();e.exports=function(){__p&&__p();var a;a=babelHelpers.inherits(c,b("WebGraphQLQueryBase"));a&&a.prototype;c.__getDocID=function(){"use strict";return"1825694550811294"};c.getQueryID=function(){"use strict";return"304616633641541"};function c(){"use strict";a.apply(this,arguments)}return c}()}),null);
__d("VideoVODCVCFetching",["ChannelManager","RTISubscriptionManager","Run","SubscriptionsHandler","VideoPlayerLoggerSource","VideoSocialFabricCVCExperiments","VideoVODCVCFetchingQueryWebGraphQLQuery","VODPresenceCVCDisplayStage","WebGraphQL","keyMirror","promiseDone"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g=b("keyMirror")(b("VODPresenceCVCDisplayStage")),h="vod_cvc/",i=1e4;b("ChannelManager").startChannelManager();function a(a){__p&&__p();this.$5=null;this.$7=i;this.$8=!1;this.$11=function(){b("VideoSocialFabricCVCExperiments").isCVCPolledByGraphQL?this.$14():b("VideoSocialFabricCVCExperiments").isCVCPolledBySkywalker&&this.$15()}.bind(this);if(!(b("VideoSocialFabricCVCExperiments").isCVCPolledByGraphQL||b("VideoSocialFabricCVCExperiments").isCVCPolledBySkywalker)||a.isAd()||a.isLiveVideo()||a.isBroadcast())return;b("VideoSocialFabricCVCExperiments").isCVCPulledPreenter&&this.$9(a,g.PRE_ENTER);a.getSource()===b("VideoPlayerLoggerSource").INLINE&&a.registerOption("VideoVODCVCFetching","currentViewerCount"+a.getVideoID(),function(){return this.$1}.bind(this),function(a){return this.$1=a}.bind(this));this.$3=new(b("SubscriptionsHandler"))();this.$3.addSubscriptions(a.addListener("beginPlayback",function(){this.$5=null}.bind(this)),a.addListener("updateStatus",function(b){a.isState("playing")&&(this.$5===null&&(this.$5=b.position),this.$5+3<=b.position&&(this.$5=Infinity,this.$10(a)))}.bind(this)),a.addListener("pausePlayback",this.$11),a.addListener("finishPlayback",this.$11),a.addListener("becomeInvisible",this.$11));b("Run").onLeave(function(){return this.cleanOnLeave()}.bind(this))}a.prototype.cleanOnLeave=function(){this.$3&&this.$3.release(),this.$11()};a.prototype.$10=function(a){b("VideoSocialFabricCVCExperiments").isCVCPolledByGraphQL?this.$12(a):b("VideoSocialFabricCVCExperiments").isCVCPolledBySkywalker&&(this.$4||(this.$4=this.$13(a)))};a.prototype.$13=function(a){return b("RTISubscriptionManager").subscribe(this.getTopic(a.getVideoID()),function(b){b=JSON.parse(b.payload);b=b.count;this.updateCVC(a,b)}.bind(this))};a.prototype.$15=function(){this.$4&&this.$4.unsubscribe(),this.$4=null};a.prototype.$12=function(a){this.$8=!1,this.$9(a,g.POST_ENTER)};a.prototype.$14=function(){this.$8=!0,clearTimeout(this.$6)};a.prototype.getQuery=function(a,c){return new(b("VideoVODCVCFetchingQueryWebGraphQLQuery"))({video_id:a.getVideoID(),stage:c})};a.prototype.$9=function(a,c){__p&&__p();var d=b("WebGraphQL").exec(this.getQuery(a,c));b("promiseDone")(d,function(b){if(this.$8)return;b=b.vod_presence_cvc;if(b){var d=b.cvc||0,e=b.is_displayed===null?!0:b.is_displayed;b=b.next_poll_ms||i;this.updateCVC(a,d,e);b>=0&&c===g.POST_ENTER&&(this.$6=setTimeout(this.$9.bind(this,a,c),b))}}.bind(this),function(b){if(this.$8)return;this.$6=setTimeout(this.$9.bind(this,a,c),this.$7);this.$7=Math.min(Number.MAX_SAFE_INTEGER,2*this.$7)}.bind(this))};a.prototype.updateCVC=function(a,c,d){d===void 0&&(d=!0),a.getSource()===b("VideoPlayerLoggerSource").INLINE&&a.setOption("VideoVODCVCFetching","currentViewerCount"+a.getVideoID(),c),a.emit("VideoVODCVC/viewCountChange",{cvc:c,shouldDisplayCVC:d})};a.prototype.getTopic=function(a){return h+a};e.exports=a}),null);
__d("EntityPresenceTypeEnum",[],(function(a,b,c,d,e,f){e.exports=Object.freeze({EXTERNAL_CASE:"external_case",FRIEND_ONE:"friend_one",GMS_SRT:"gms_srt",LIVE_VIDEO:"live_video",LIVING_ROOM:"living_room",SPECTACLES:"spectacles",SRT_CUSTOMER_SUPPORT:"srt_customer_support",VOD:"vod"})}),null);
__d("VideoPlayerFormatsID",[],(function(a,b,c,d,e,f){e.exports=Object.freeze({UNKNOWN:0,INLINE:1,SNOWLIFT:2,PERMALINK:3,CHANNEL:4,FULL_SCREEN:5,SOCIAL_PLAYER:6,TV:7,MISC:8,WATCH_SCROLL:9,WATCH_SCROLL_APP_BACKGROUND:10,WATCH_AND_GO:11,WATCH_AND_BROWSE:12,CANVAS:13,TAHOE:14,FB_STORIES:15})}),null);
__d("VideoPlayerSourceID",[],(function(a,b,c,d,e,f){e.exports=Object.freeze({UNKNOWN:0,TOP_LIVE_BOOKMARK:1,VIDEO_HOME:2,MEDIA_GALLERY:3,DIRECT_INBOX:4,FB_STORIES:5,BACKSTAGE:6,NOTIFICATIONS:7,LIVING_ROOM_RECAP:8,LIVING_ROOM:9,INSTANT_SHOPPING:10,GROUP:11,COMMERCE:12,NEWSFEED:13,PHOTOSFEED:14,PERMALINK:15,INSTANT_ARTICLES:16,PAGE_TIMELINE:17,EVENTS:18,EXPLORE_FEED:19,SEARCH:20,MOVIE_CHECKOUT_FLOW:21,LIVE_CHAINING:22,SAVED:23,USER_TIMELINE:24})}),null);
__d("VideoVODCVCSubscription",["EntityPresenceManager","EntityPresenceTypeEnum","Int64","Run","SubscriptionsHandler","VideoPlayerFormats","VideoPlayerFormatsID","VideoPlayerLoggerEvent","VideoPlayerOrigins","VideoPlayerSourceID","VideoSocialFabricCVCExperiments","VideoVODCVCFetchingQueryWebGraphQLQuery","WebGraphQL","promiseDone"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g=42,h=7,i=5;function a(a){__p&&__p();this.$8=function(){this.$6=null,this.$5&&(this.$5&&this.$5.leave(),this.$5=null)}.bind(this);if(!b("VideoSocialFabricCVCExperiments").isCVCSubscriptionEnabled||a.isAd()||a.isLiveVideo()||a.isBroadcast())return;this.$1=new(b("SubscriptionsHandler"))();this.$5=null;this.$2=a;this.$4=!1;this.$3=this.$2.getPlayerOrigin();this.$6=null;this.$1.addSubscriptions(a.addListener("beginPlayback",function(){this.$6=null}.bind(this)),a.addListener("updateStatus",function(a){this.$2.isState("playing")&&(this.$6===null&&(this.$6=a.position),this.$6+3<=a.position&&(this.$2.logEvent(b("VideoPlayerLoggerEvent").PLAYED_FOR_THREE_SECONDS),this.$6=Infinity,this.$7()))}.bind(this)),a.addListener("pausePlayback",this.$8),a.addListener("finishPlayback",this.$8),a.addListener("becomeInvisible",this.$8),a.addListener("seekEnd",this.$8),a.addListener("TahoeController/exitTahoe",this.$8));b("Run").onLeave(function(){return this.cleanOnLeave()}.bind(this))}a.prototype.cleanOnLeave=function(){this.$8(),this.$1&&this.$1.release()};a.prototype.$7=function(){if(this.$5)return;b("promiseDone")(b("WebGraphQL").exec(new(b("VideoVODCVCFetchingQueryWebGraphQLQuery"))({video_id:"$"+this.$2.getVideoID()})));this.$5=b("EntityPresenceManager").enter(b("EntityPresenceTypeEnum").VOD,this.$2.getVideoID(),this.getLoggingCapabilitiesForEntityPresence())};a.prototype.getLoggingCapabilitiesForEntityPresence=function(){__p&&__p();var a=b("Int64").fromInt(0);a=b("Int64").fromString(Date.now().toString());var c=7;a=a.shiftLeft(c);b("VideoSocialFabricCVCExperiments").isCVCPolledBySkywalker||(a=a.add(b("Int64").fromInt(1)));c=64-(g+h+i+c);a=a.shiftLeft(c);a=a.shiftLeft(i);a=a.add(b("Int64").fromInt(this.mapPlayerFormatToCapabilityBits(this.$2.getPlayerFormat())));a=a.shiftLeft(h);a=a.add(b("Int64").fromInt(this.mapPlayerOriginToCapabilityBits(this.$3)));return a};a.prototype.mapPlayerOriginToCapabilityBits=function(a){__p&&__p();if(a===null)return b("VideoPlayerSourceID").UNKNOWN;switch(a){case b("VideoPlayerOrigins").COMMERCE:return b("VideoPlayerSourceID").COMMERCE;case b("VideoPlayerOrigins").DIRECT_INBOX:return b("VideoPlayerSourceID").DIRECT_INBOX;case b("VideoPlayerOrigins").EVENTS:return b("VideoPlayerSourceID").EVENTS;case b("VideoPlayerOrigins").EXPLORE_FEED:return b("VideoPlayerSourceID").EXPLORE_FEED;case b("VideoPlayerOrigins").FB_STORIES:return b("VideoPlayerSourceID").FB_STORIES;case b("VideoPlayerOrigins").GROUP:return b("VideoPlayerSourceID").GROUP;case b("VideoPlayerOrigins").INSTANT_ARTICLES:return b("VideoPlayerSourceID").INSTANT_ARTICLES;case b("VideoPlayerOrigins").INSTANT_SHOPPING:return b("VideoPlayerSourceID").INSTANT_ARTICLES;case b("VideoPlayerOrigins").LIVE_CHAINING:return b("VideoPlayerSourceID").LIVE_CHAINING;case b("VideoPlayerOrigins").LIVING_ROOM:return b("VideoPlayerSourceID").LIVING_ROOM;case b("VideoPlayerOrigins").LIVING_ROOM_RECAP:return b("VideoPlayerSourceID").LIVING_ROOM_RECAP;case b("VideoPlayerOrigins").MEDIA_GALLERY:return b("VideoPlayerSourceID").MEDIA_GALLERY;case b("VideoPlayerOrigins").MOVIE_CHECKOUT_FLOW:return b("VideoPlayerSourceID").MOVIE_CHECKOUT_FLOW;case b("VideoPlayerOrigins").NEWSFEED:return b("VideoPlayerSourceID").NEWSFEED;case b("VideoPlayerOrigins").NOTIFICATIONS:return b("VideoPlayerSourceID").NOTIFICATIONS;case b("VideoPlayerOrigins").PAGE_TIMELINE:return b("VideoPlayerSourceID").PAGE_TIMELINE;case b("VideoPlayerOrigins").PERMALINK:return b("VideoPlayerSourceID").PERMALINK;case b("VideoPlayerOrigins").PHOTOSFEED:return b("VideoPlayerSourceID").PHOTOSFEED;case b("VideoPlayerOrigins").SAVED:return b("VideoPlayerSourceID").SAVED;case b("VideoPlayerOrigins").SEARCH:return b("VideoPlayerSourceID").SEARCH;case b("VideoPlayerOrigins").TOP_LIVE_BOOKMARK:return b("VideoPlayerSourceID").TOP_LIVE_BOOKMARK;case b("VideoPlayerOrigins").USER_TIMELINE:return b("VideoPlayerSourceID").USER_TIMELINE;case b("VideoPlayerOrigins").VIDEO_HOME:return b("VideoPlayerSourceID").VIDEO_HOME;case b("VideoPlayerOrigins").UNKNOWN:default:return b("VideoPlayerSourceID").UNKNOWN}};a.prototype.mapPlayerFormatToCapabilityBits=function(a){__p&&__p();if(a===null)return b("VideoPlayerFormatsID").UNKNOWN;switch(a){case b("VideoPlayerFormats").INLINE:return b("VideoPlayerFormatsID").INLINE;case b("VideoPlayerFormats").SNOWLIFT:return b("VideoPlayerFormatsID").SNOWLIFT;case b("VideoPlayerFormats").PERMALINK:return b("VideoPlayerFormatsID").PERMALINK;case b("VideoPlayerFormats").CHANNEL:return b("VideoPlayerFormatsID").CHANNEL;case b("VideoPlayerFormats").FULL_SCREEN:return b("VideoPlayerFormatsID").FULL_SCREEN;case b("VideoPlayerFormats").SOCIAL_PLAYER:return b("VideoPlayerFormatsID").SOCIAL_PLAYER;case b("VideoPlayerFormats").TV:return b("VideoPlayerFormatsID").TV;case b("VideoPlayerFormats").MISC:return b("VideoPlayerFormatsID").MISC;case b("VideoPlayerFormats").WATCH_SCROLL:return b("VideoPlayerFormatsID").WATCH_SCROLL;case b("VideoPlayerFormats").WATCH_SCROLL_APP_BACKGROUND:return b("VideoPlayerFormatsID").WATCH_SCROLL_APP_BACKGROUND;case b("VideoPlayerFormats").WATCH_AND_GO:return b("VideoPlayerFormatsID").WATCH_AND_GO;case b("VideoPlayerFormats").WATCH_AND_BROWSE:return b("VideoPlayerFormatsID").WATCH_AND_BROWSE;case b("VideoPlayerFormats").CANVAS:return b("VideoPlayerFormatsID").CANVAS;case b("VideoPlayerFormats").TAHOE:return b("VideoPlayerFormatsID").TAHOE;case b("VideoPlayerFormats").FB_STORIES:return b("VideoPlayerFormatsID").FB_STORIES;default:return b("VideoPlayerFormatsID").UNKNOWN}};e.exports=a}),null);
__d("VideoWithFluentUFISupport",["UFIVideoPlayerRegistry"],(function(a,b,c,d,e,f){function a(a){"use strict";b("UFIVideoPlayerRegistry").registerVideoPlayerController(a)}e.exports=a}),null);
__d("VideoWithSequentialAutoplay",["Arbiter","SubscriptionsHandler","VideoPlayerHTML5Experiments","VideoPlayerReason","destroyOnUnload"],(function(a,b,c,d,e,f){__p&&__p();function a(a,c){"use strict";__p&&__p();this.$1=a;this.$2=c;this.$3=new(b("SubscriptionsHandler"))();if(b("VideoPlayerHTML5Experiments").displayLoopingWhenAutoplayNextVideo&&this.$2&&this.$2!=="0")if(this.$1.hasOption("Looping","disabled"))this.$1.setOption("Looping","disabled",!0);else{var d=this.$1.addListener("optionsChange",function(){this.$1.hasOption("Looping","disabled")&&(this.$1.setOption("Looping","disabled",!0),d.remove())}.bind(this));this.$3.addSubscriptions(d)}this.$1.addListener("finishPlayback",this.$4.bind(this));this.$3.addSubscriptions(b("Arbiter").subscribe("nextVideoAutoplay",function(a,c){c.nextVideoID==this.$1.getVideoID()&&this.$1.play(b("VideoPlayerReason").AUTOPLAY)}.bind(this)));b("destroyOnUnload")(function(){return this.$3.release()}.bind(this))}a.prototype.$4=function(){"use strict";b("Arbiter").inform("nextVideoAutoplay",{nextVideoID:this.$2})};e.exports=a}),null);
__d("XVideoWithRapidFeedbackAsyncController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/video/instream_video/rapid_feedback/async/",{ad_type:{type:"Enum",required:!0,enumType:1},video_id:{type:"String",required:!0},ad_client_token:{type:"String"},elapsed_time_since_ad:{type:"Float"},ad_position_in_video:{type:"Float"},player_origin:{type:"Enum",enumType:1},player_sub_origin:{type:"String"},player_format:{type:"Enum",enumType:1},script_path:{type:"String"},is_indicator_shown:{type:"Bool",defaultValue:!1},is_ad_complete:{type:"Bool",defaultValue:!1}})}),null);
__d("VideoWithRapidFeedback",["AsyncRequest","DateConsts","ScriptPath","VideoPlayerStates","ViewportTrackingHelper","XVideoWithRapidFeedbackAsyncController","onViewportChanged"],(function(a,b,c,d,e,f){__p&&__p();var g=10*b("DateConsts").MS_PER_SEC;function a(a,c){"use strict";this.$1=a,this.$2=c,this.$3=0,this.$4=0,this.$6=!1,this.$7=!1,a.isState(b("VideoPlayerStates").PLAYING)&&this.$8(),a.addListener("beginPlayback",this.$8.bind(this)),a.addListener("pausePlayback",this.$9.bind(this)),a.addListener("commercialBreak/vodBreakStarting",this.$10.bind(this)),a.addListener("commercialBreak/showUFI",this.$11.bind(this)),this.$5=this.$12(),b("onViewportChanged")(this.$13.bind(this))}a.prototype.$8=function(){"use strict";this.$3===0&&(this.$3=Date.now())};a.prototype.$9=function(){"use strict";this.$3>0&&(this.$4+=Date.now()-this.$3),this.$3=0};a.prototype.$10=function(){"use strict";this.$6=!0};a.prototype.$11=function(){"use strict";this.$6&&(this.$7=!0)};a.prototype.$13=function(){"use strict";__p&&__p();if(this.$1.isState(b("VideoPlayerStates").DESTROYED))return;var a=this.$5;this.$5=this.$12();if(a&&!this.$5){a=this.$4;this.$3>0&&(a+=Date.now()-this.$3);a>g&&(this.$4=0,this.$3=0,this.$14())}};a.prototype.$12=function(){"use strict";return b("ViewportTrackingHelper").isVisible(this.$1.getRootNode(),0)};a.prototype.$14=function(){"use strict";var a=null,c=null,d=null,e=null,f=null,g=null,h=this.$1.getOption("VideoWithInstreamVideo","controller");if(h){h=h.getMostRecentAdInfo();h&&h.adClientToken&&(a=h.adClientToken,c=Date.now()-h.adStartPlayingTimeMs,d=h.adPositionInVideoMs,e=h.playerOrigin,f=h.playerSubOrigin,g=h.playerFormat)}h=b("XVideoWithRapidFeedbackAsyncController").getURIBuilder().setEnum("ad_type",this.$2).setString("video_id",this.$1.getVideoID()).setString("ad_client_token",a).setFloat("elapsed_time_since_ad",c).setFloat("ad_position_in_video",d).setEnum("player_format",g).setEnum("player_origin",e).setString("player_sub_origin",f).setString("script_path",b("ScriptPath").getScriptPath()).setBool("is_indicator_shown",this.$6).setBool("is_ad_complete",this.$7);new(b("AsyncRequest"))(h.getURI()).send()};e.exports=a}),null);
__d("VideoPlayerRegistryComponent",["invariant","SubscriptionsHandler","VideoPlayerRegistry"],(function(a,b,c,d,e,f,g){__p&&__p();function a(a){"use strict";this.$1=a||null,this.$2=new(b("SubscriptionsHandler"))(),this.$1&&this.$3()}a.prototype.destroy=function(){"use strict";this.$4(),this.$1=null};a.prototype.getController=function(){"use strict";var a=this.$1;a||g(0,undefined);return a};a.prototype.enable=function(a){"use strict";this.$1&&this.$1!==a&&this.$4(),this.$1=a,this.$3()};a.prototype.disable=function(a){"use strict";this.$4()};a.prototype.$3=function(){"use strict";var a=this.getController();b("VideoPlayerRegistry").add(a);this.$2.addSubscriptions(a.addListener("stateChange",function(){a.isState("destroyed")&&this.destroy()}.bind(this)))};a.prototype.$4=function(){"use strict";var a=this.getController();this.$2.release();this.$2.engage();b("VideoPlayerRegistry").remove(a)};e.exports=a}),null);
__d("PlayerKeyboardControls.react",["ix","cx","CenteredContainer.react","Event","EventListener","FBCircularGlyph.react","Image.react","Keys","LiveRewindUtils","LiveVideoPlayerActions","LiveVideoRewindLoggerEvent","React","ReactDOM","VideoPlayerLoggerSource","VideoPlayerReason","asset","clamp","joinClasses"],(function(a,b,c,d,e,f,g,h){__p&&__p();var i,j=10,k=.1;c=babelHelpers.inherits(a,b("React").Component);i=c&&c.prototype;function a(){var a,b;for(var c=arguments.length,d=new Array(c),e=0;e<c;e++)d[e]=arguments[e];return b=(a=i.constructor).call.apply(a,[this].concat(d)),this.state={action:null},b}a.prototype.componentDidMount=function(){"use strict";this.$1=b("EventListener").listen(this.props.controller.getRootNode(),"keydown",this.$2.bind(this))};a.prototype.componentWillUnmount=function(){"use strict";this.$1&&this.$1.remove()};a.prototype.$3=function(){"use strict";if(!this.props.isLiveRewindEnabled)return;var a=this.props.controller,c=a.getCurrentTimePosition();this.setState({action:"pause"});a.pause(b("VideoPlayerReason").USER);b("LiveVideoPlayerActions").setIsRewound(a,!0);b("LiveRewindUtils").logLiveRewindEvent(b("LiveVideoRewindLoggerEvent").PAUSE,a,null,c,null,c)};a.prototype.$4=function(){"use strict";if(!this.props.isLiveRewindEnabled)return;var a=this.props.controller,c=a.getCurrentTimePosition();this.setState({action:"play"});a.play(b("VideoPlayerReason").USER);b("LiveRewindUtils").logLiveRewindEvent(b("LiveVideoRewindLoggerEvent").PLAY,a,null,c,null,c)};a.prototype.$5=function(){"use strict";return this.props.seekFrameWhenPaused&&!this.props.controller.isState("playing")?1/30:this.props.seekIncrement};a.prototype.$2=function(a){"use strict";__p&&__p();var c=this.props.controller,d=this.props.controller.getSource()===b("VideoPlayerLoggerSource").TAHOE;if(this.props.isFullscreenRequired&&!c.isFullscreen())return;var e=c.getCurrentTimePosition(),f=c.getVolume();switch(b("Event").getKeyCode(a)){case b("Keys").SPACE:d&&a.preventDefault();if(c.isState("playing")){if(this.props.isLiveStreaming){this.$3();break}this.setState({action:"pause"});c.pause(b("VideoPlayerReason").USER)}else{if(this.props.isLiveStreaming){this.$4();break}this.setState({action:"play"});c.play(b("VideoPlayerReason").USER)}break;case b("Keys").LEFT:if(this.props.isLiveStreaming){this.props.isLiveRewindEnabled&&(b("LiveRewindUtils").seekBack(c),this.setState({action:"rewind"}));break}this.setState({action:"rewind"});c.seek(e-this.$5());break;case b("Keys").RIGHT:if(this.props.isLiveStreaming){this.props.isLiveRewindEnabled&&(b("LiveRewindUtils").seekForward(c),this.setState({action:"forward"}));break}this.setState({action:"forward"});c.seek(e+this.$5());break;case b("Keys").UP:if(!c.isBroadcaster()&&c.isAudioBlocked())break;d&&a.preventDefault();e=Math.min(f+k,1);this.setState({action:"volume-up"});c.setVolume(e);c.isMuted()&&c.unmute();break;case b("Keys").DOWN:if(!c.isBroadcaster()&&c.isAudioBlocked())break;d&&a.preventDefault();e=Math.max(f-k,0);e<.001?(this.setState({action:"mute"}),c.mute()):(this.setState({action:"volume-down"}),c.setVolume(e));break;case b("Keys").M:if(!c.isBroadcaster()&&c.isAudioBlocked())break;c.isMuted()?(this.setState({action:"unmute"}),c.unmute()):(this.setState({action:"mute"}),c.mute());break;case b("Keys").F:c.isFullscreen()?this.setState({action:"exit-fs"}):this.setState({action:"enter-fs"});setTimeout(function(){return c.toggleFullscreen()},100);break;case b("Keys").COMMA:this.props.enablePlaybackRateControl&&c.setPlaybackRate(b("clamp")(c.getPlaybackRate()/2,.5,1));break;case b("Keys").PERIOD:this.props.enablePlaybackRateControl&&c.setPlaybackRate(b("clamp")(c.getPlaybackRate()*2,1,2));break}};a.prototype.render=function(){"use strict";__p&&__p();if(!this.state.action)return null;var a=this.props.controller,c="",d="",e=null;switch(this.state.action){case"play":c=g("476305");break;case"pause":c=g("476304");break;case"rewind":c=g("476307");d="_380-";a.isState("playing")?e=this.props.seekIncrement!==j?null:b("React").createElement(b("Image.react"),{className:"_pa6",src:g("476306")}):e=this.props.seekFrameWhenPaused?null:b("React").createElement(b("Image.react"),{className:"_pa6",src:g("476306")});break;case"forward":c=g("476308");d="_3813";a.isState("playing")?e=this.props.seekIncrement!==j?null:b("React").createElement(b("Image.react"),{className:"_pa6",src:g("476306")}):e=this.props.seekFrameWhenPaused?null:b("React").createElement(b("Image.react"),{className:"_pa6",src:g("476306")});break;case"volume-up":case"unmute":c=g("476301");break;case"volume-down":c=g("476302");break;case"mute":c=g("476303");break;case"enter-fs":c=g("476310");break;case"exit-fs":c=g("476309");break}a=b("React").createElement(b("FBCircularGlyph.react"),{circleSize:120,className:b("joinClasses")(d,"_3814"),glyph:c,ref:function(a){a=b("ReactDOM").findDOMNode(a);if(!a||!d)return;a.classList.remove(d);void a.offsetWidth;a.classList.add(d)}});return b("React").createElement(b("CenteredContainer.react"),{className:"_3815 _381b",fullHeight:!0,horizontal:!0,ref:function(a){a=b("ReactDOM").findDOMNode(a);if(!a)return;a.classList.remove("_381b");void a.offsetWidth;a.classList.add("_381b")},vertical:!0},b("React").createElement("div",null,a,e))};a.defaultProps={enablePlaybackRateControl:!1,isFullscreenRequired:!1,seekIncrement:j,seekFrameWhenPaused:!1};e.exports=a}),null);